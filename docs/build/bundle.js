var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function s(t){t.forEach(e)}function o(t){return"function"==typeof t}function r(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}let l,c;function i(t,e){return l||(l=document.createElement("a")),l.href=e,t===l.href}function a(e,n,s){e.$$.on_destroy.push(function(e,...n){if(null==e)return t;const s=e.subscribe(...n);return s.unsubscribe?()=>s.unsubscribe():s}(n,s))}function u(t,e,n,s){if(t){const o=d(t,e,n,s);return t[0](o)}}function d(t,e,n,s){return t[1]&&s?function(t,e){for(const n in e)t[n]=e[n];return t}(n.ctx.slice(),t[1](s(e))):n.ctx}function p(t,e,n,s){if(t[2]&&s){const o=t[2](s(n));if(void 0===e.dirty)return o;if("object"==typeof o){const t=[],n=Math.max(e.dirty.length,o.length);for(let s=0;s<n;s+=1)t[s]=e.dirty[s]|o[s];return t}return e.dirty|o}return e.dirty}function f(t,e,n,s,o,r){if(o){const l=d(e,n,s,r);t.p(l,o)}}function h(t){if(t.ctx.length>32){const e=[],n=t.ctx.length/32;for(let t=0;t<n;t++)e[t]=-1;return e}return-1}function m(t){return null==t?"":t}function $(t,e){t.appendChild(e)}function v(t,e,n){t.insertBefore(e,n||null)}function g(t){t.parentNode.removeChild(t)}function _(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function b(t){return document.createElement(t)}function w(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function y(t){return document.createTextNode(t)}function x(){return y(" ")}function k(){return y("")}function S(t,e,n,s){return t.addEventListener(e,n,s),()=>t.removeEventListener(e,n,s)}function L(t){return function(e){return e.preventDefault(),t.call(this,e)}}function M(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function T(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function N(t,e){t.value=null==e?"":e}function q(t,e,n,s){t.style.setProperty(e,n,s?"important":"")}function C(t,e){for(let n=0;n<t.options.length;n+=1){const s=t.options[n];if(s.__value===e)return void(s.selected=!0)}t.selectedIndex=-1}function E(t){c=t}function F(){const t=function(){if(!c)throw new Error("Function called outside component initialization");return c}();return(e,n)=>{const s=t.$$.callbacks[e];if(s){const o=function(t,e,n=!1){const s=document.createEvent("CustomEvent");return s.initCustomEvent(t,n,!1,e),s}(e,n);s.slice().forEach((e=>{e.call(t,o)}))}}}const H=[],z=[],I=[],j=[],A=Promise.resolve();let O=!1;function R(t){I.push(t)}function P(t){j.push(t)}let J=!1;const B=new Set;function W(){if(!J){J=!0;do{for(let t=0;t<H.length;t+=1){const e=H[t];E(e),Z(e.$$)}for(E(null),H.length=0;z.length;)z.pop()();for(let t=0;t<I.length;t+=1){const e=I[t];B.has(e)||(B.add(e),e())}I.length=0}while(H.length);for(;j.length;)j.pop()();O=!1,J=!1,B.clear()}}function Z(t){if(null!==t.fragment){t.update(),s(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(R)}}const D=new Set;let V;function X(){V={r:0,c:[],p:V}}function G(){V.r||s(V.c),V=V.p}function K(t,e){t&&t.i&&(D.delete(t),t.i(e))}function Q(t,e,n,s){if(t&&t.o){if(D.has(t))return;D.add(t),V.c.push((()=>{D.delete(t),s&&(n&&t.d(1),s())})),t.o(e)}}const U="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;function Y(t,e){Q(t,1,1,(()=>{e.delete(t.key)}))}function tt(t,e,n,s,o,r,l,c,i,a,u,d){let p=t.length,f=r.length,h=p;const m={};for(;h--;)m[t[h].key]=h;const $=[],v=new Map,g=new Map;for(h=f;h--;){const t=d(o,r,h),c=n(t);let i=l.get(c);i?s&&i.p(t,e):(i=a(c,t),i.c()),v.set(c,$[h]=i),c in m&&g.set(c,Math.abs(h-m[c]))}const _=new Set,b=new Set;function w(t){K(t,1),t.m(c,u),l.set(t.key,t),u=t.first,f--}for(;p&&f;){const e=$[f-1],n=t[p-1],s=e.key,o=n.key;e===n?(u=e.first,p--,f--):v.has(o)?!l.has(s)||_.has(s)?w(e):b.has(o)?p--:g.get(s)>g.get(o)?(b.add(s),w(e)):(_.add(o),p--):(i(n,l),p--)}for(;p--;){const e=t[p];v.has(e.key)||i(e,l)}for(;f;)w($[f-1]);return $}function et(t,e,n){const s=t.$$.props[e];void 0!==s&&(t.$$.bound[s]=n,n(t.$$.ctx[s]))}function nt(t){t&&t.c()}function st(t,n,r,l){const{fragment:c,on_mount:i,on_destroy:a,after_update:u}=t.$$;c&&c.m(n,r),l||R((()=>{const n=i.map(e).filter(o);a?a.push(...n):s(n),t.$$.on_mount=[]})),u.forEach(R)}function ot(t,e){const n=t.$$;null!==n.fragment&&(s(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function rt(t,e){-1===t.$$.dirty[0]&&(H.push(t),O||(O=!0,A.then(W)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function lt(e,o,r,l,i,a,u,d=[-1]){const p=c;E(e);const f=e.$$={fragment:null,ctx:null,props:a,update:t,not_equal:i,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(p?p.$$.context:o.context||[]),callbacks:n(),dirty:d,skip_bound:!1,root:o.target||p.$$.root};u&&u(f.root);let h=!1;if(f.ctx=r?r(e,o.props||{},((t,n,...s)=>{const o=s.length?s[0]:n;return f.ctx&&i(f.ctx[t],f.ctx[t]=o)&&(!f.skip_bound&&f.bound[t]&&f.bound[t](o),h&&rt(e,t)),n})):[],f.update(),h=!0,s(f.before_update),f.fragment=!!l&&l(f.ctx),o.target){if(o.hydrate){const t=function(t){return Array.from(t.childNodes)}(o.target);f.fragment&&f.fragment.l(t),t.forEach(g)}else f.fragment&&f.fragment.c();o.intro&&K(e.$$.fragment),st(e,o.target,o.anchor,o.customElement),W()}E(p)}class ct{$destroy(){ot(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const it=[];class at{constructor(e){this.writable=function(e,n=t){let s;const o=new Set;function l(t){if(r(e,t)&&(e=t,s)){const t=!it.length;for(const t of o)t[1](),it.push(t,e);if(t){for(let t=0;t<it.length;t+=2)it[t][0](it[t+1]);it.length=0}}}return{set:l,update:function(t){l(t(e))},subscribe:function(r,c=t){const i=[r,c];return o.add(i),1===o.size&&(s=n(l)||t),r(e),()=>{o.delete(i),0===o.size&&(s(),s=null)}}}}(e),this.subscribe=this.writable.subscribe,this.set=this.writable.set}add(t,e){this.writable.update((n=>(n[t]=e,n)))}get(){let t;return this.writable.update((e=>(t=e,e))),t}}let ut,dt;const pt=Math.min(Math.floor(.9*innerWidth),544),ft=`{\n\t"scheme": "sepia",\n\t"book-width": ${pt},\n\t"book-width-tmp": ${pt},\n\t"book-height-tmp": 4,\n\t"book-height": 4,\n\t"font-weight": 400,\n\t"font-family": "RobotoSlab",\n\t"font-size": 16\n}`,ht=localStorage.getItem("theme")||ft;let mt=new class extends at{constructor(){super(JSON.parse(ht))}get(t){return super.get()[t]}add(t,e){super.add(t,e),document.body.style.setProperty(`--${t}`,"string"==typeof e?`"${e}"`:e),localStorage.setItem("theme",JSON.stringify(super.get()))}},$t=new class extends at{constructor(){super({}),this.active="home",this.prevent="home",ut=this}set active(t){this._active=t,this.add("active",t)}get active(){return this._active}get prevent(){return this._prevent}set prevent(t){this._prevent=t,this.add("prevent",t)}toPrevent(){[ut.active,ut.prevent]=[ut.prevent,ut.active],ut.active==ut.prevent&&"book"==ut.active&&(ut.active="home")}},vt=new class extends at{constructor(){super({listId:[]}),this._list={},dt=this,this.set({list:Object.keys(this._list)})}addFiles(t){for(const e of t){const t=e.name;if(!e.name.endsWith(".fb2")){console.log(t+" not fictionbook");continue}const n=new FileReader;n.readAsText(e),n.onload=e=>{const s=n.result;this.add(t,{data:s,inited:!1})}}}async update(){[...(await fetch("books.txt").then((t=>t.text()))).split("\n")].map((t=>t.trim())).forEach((async t=>{const e=await fetch("books/"+t).then((t=>t.text()));dt.add(t,{data:e,inited:!1})}))}get active(){return this._active}set active(t){this._active=t,super.add("active",t)}add(t,e){this._list[t]=e,super.add("list",this._list),super.add("listId",Object.keys(this._list))}};function gt(e){let n,s,o,r,l,c;return{c(){n=b("button"),s=w("svg"),o=w("path"),M(o,"d","M0 3l5 2.9V0L0 3zm16.5-.5h-12v1h12v-1z"),M(s,"viewBox","0 0 17 6.5"),M(s,"width","17"),M(n,"class",r="btn btn--back "+e[0])},m(t,e){v(t,n,e),$(n,s),$(s,o),l||(c=S(n,"click",$t.toPrevent),l=!0)},p(t,[e]){1&e&&r!==(r="btn btn--back "+t[0])&&M(n,"class",r)},i:t,o:t,d(t){t&&g(n),l=!1,c()}}}function _t(t,e,n){let{class:s}=e;return t.$$set=t=>{"class"in t&&n(0,s=t.class)},[s]}class bt extends ct{constructor(t){super(),lt(this,t,_t,gt,r,{class:0})}}function wt(e){let n,o,r,l,c,i;return{c(){n=b("button"),o=w("svg"),r=w("path"),M(r,"d","M13.3 8.5V7l1.6-1.2c.1-.2.2-.3 0-.5l-1.4-2.6c-.1-.2-.3-.2-.5-.2l-1.9.8-1.2-.8-.3-2a.4.4 0 00-.4-.2h-3a.4.4 0 00-.4.3l-.2 2a6 6 0 00-1.3.7l-1.9-.8a.4.4 0 00-.4.2L.5 5.3a.4.4 0 000 .5L2.2 7v1.5L.6 9.7a.4.4 0 000 .5L2 12.8c0 .2.3.2.5.2l1.8-.8 1.3.8.3 2 .4.2h3c.1 0 .3-.1.3-.3l.3-2c.5-.1.9-.4 1.3-.7l1.8.8c.2 0 .4 0 .5-.2l1.5-2.6v-.5l-1.7-1.2zm-5.6 1.9a2.6 2.6 0 110-5.3 2.6 2.6 0 010 5.3z"),M(o,"viewBox","0 0 16 16"),M(o,"width","16"),M(n,"class",l="btn btn--settings "+e[0])},m(t,s){v(t,n,s),$(n,o),$(o,r),c||(i=[S(n,"mouseout",e[2]),S(n,"mouseover",e[1])],c=!0)},p(t,[e]){1&e&&l!==(l="btn btn--settings "+t[0])&&M(n,"class",l)},i:t,o:t,d(t){t&&g(n),c=!1,s(i)}}}function yt(t,e,n){let{class:s}=e;return t.$$set=t=>{"class"in t&&n(0,s=t.class)},[s,()=>{document.querySelector(".header__settings").classList.add("popup-wrapper--active")},()=>{document.querySelector(".header__settings").classList.remove("popup-wrapper--active")}]}class xt extends ct{constructor(t){super(),lt(this,t,yt,wt,r,{class:0})}}function kt(e){let n,o,r,l,c,i;return{c(){n=b("button"),o=w("svg"),r=w("path"),M(r,"d","M4 1a1 1 0 0 1 1-1h13a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V1ZM4 6a1 1 0 0 1 1-1h13a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V6ZM4 11a1 1 0 0 1 1-1h13a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-1ZM3 1.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0ZM3 6.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0ZM3 11.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0Z"),M(o,"viewBox","0 0 19 13"),M(o,"width","18"),M(o,"fill","currentColor"),M(n,"class",l="btn btn--chapters "+e[0])},m(t,s){v(t,n,s),$(n,o),$(o,r),c||(i=[S(n,"mouseout",e[2]),S(n,"mouseover",e[1])],c=!0)},p(t,[e]){1&e&&l!==(l="btn btn--chapters "+t[0])&&M(n,"class",l)},i:t,o:t,d(t){t&&g(n),c=!1,s(i)}}}function St(t,e,n){let{class:s}=e;return t.$$set=t=>{"class"in t&&n(0,s=t.class)},[s,()=>{document.querySelector(".header__chapters").classList.add("popup-wrapper--active")},()=>{document.querySelector(".header__chapters").classList.remove("popup-wrapper--active")}]}class Lt extends ct{constructor(t){super(),lt(this,t,St,kt,r,{class:0})}}function Mt(e){let n,s,o,r,l,c,i,a;return{c(){n=b("label"),s=b("input"),o=x(),r=b("span"),l=y("+"),M(s,"type","file"),s.multiple=!0,M(s,"accept",".fb2"),M(s,"class","svelte-1caecej"),M(r,"class",c="btn btn--add "+e[0]+" svelte-1caecej"),M(n,"class","add-book svelte-1caecej")},m(t,c){v(t,n,c),$(n,s),$(n,o),$(n,r),$(r,l),i||(a=S(s,"input",e[1]),i=!0)},p(t,[e]){1&e&&c!==(c="btn btn--add "+t[0]+" svelte-1caecej")&&M(r,"class",c)},i:t,o:t,d(t){t&&g(n),i=!1,a()}}}function Tt(t,e,n){let{class:s}=e;return t.$$set=t=>{"class"in t&&n(0,s=t.class)},[s,async function(t){for(const e of t.target.files){const t=new FileReader,n=e.name;t.readAsText(e),t.onload=e=>{const s=t.result;vt.add(n,{data:s,inited:!1})}}}]}class Nt extends ct{constructor(t){super(),lt(this,t,Tt,Mt,r,{class:0})}}function qt(t){let e,n;return e=new Lt({props:{class:"header__btn"}}),{c(){nt(e.$$.fragment)},m(t,s){st(e,t,s),n=!0},i(t){n||(K(e.$$.fragment,t),n=!0)},o(t){Q(e.$$.fragment,t),n=!1},d(t){ot(e,t)}}}function Ct(t){let e,n;return e=new Nt({props:{class:"header__btn"}}),{c(){nt(e.$$.fragment)},m(t,s){st(e,t,s),n=!0},i(t){n||(K(e.$$.fragment,t),n=!0)},o(t){Q(e.$$.fragment,t),n=!1},d(t){ot(e,t)}}}function Et(t){let e,n,s,o,r,l,c;e=new bt({props:{class:"header__btn"}}),s=new xt({props:{class:"header__btn"}});let i="book"==t[1].active&&t[0].length&&qt(),a="home"==t[1].active&&Ct();return{c(){nt(e.$$.fragment),n=x(),nt(s.$$.fragment),o=x(),i&&i.c(),r=x(),a&&a.c(),l=k()},m(t,u){st(e,t,u),v(t,n,u),st(s,t,u),v(t,o,u),i&&i.m(t,u),v(t,r,u),a&&a.m(t,u),v(t,l,u),c=!0},p(t,[e]){"book"==t[1].active&&t[0].length?i?3&e&&K(i,1):(i=qt(),i.c(),K(i,1),i.m(r.parentNode,r)):i&&(X(),Q(i,1,1,(()=>{i=null})),G()),"home"==t[1].active?a?2&e&&K(a,1):(a=Ct(),a.c(),K(a,1),a.m(l.parentNode,l)):a&&(X(),Q(a,1,1,(()=>{a=null})),G())},i(t){c||(K(e.$$.fragment,t),K(s.$$.fragment,t),K(i),K(a),c=!0)},o(t){Q(e.$$.fragment,t),Q(s.$$.fragment,t),Q(i),Q(a),c=!1},d(t){ot(e,t),t&&g(n),ot(s,t),t&&g(o),i&&i.d(t),t&&g(r),a&&a.d(t),t&&g(l)}}}function Ft(t,e,n){let s,o;a(t,vt,(t=>n(3,s=t))),a(t,$t,(t=>n(1,o=t)));let r,l=[];return t.$$.update=()=>{12&t.$$.dirty&&(n(2,r=s.list[s.active]),r&&r.chapters&&n(0,l=r.chapters))},[l,o,r,s]}class Ht extends ct{constructor(t){super(),lt(this,t,Ft,Et,r,{})}}function zt(){const t=document.body,e=document.webkitIsFullScreen||document.mozFullScreen||!1;t.requestFullScreen=t.requestFullScreen||t.webkitRequestFullScreen||t.mozRequestFullScreen||function(){return!1},document.cancelFullScreen=document.cancelFullScreen||document.webkitCancelFullScreen||document.mozCancelFullScreen||function(){return!1},e?document.cancelFullScreen():t.requestFullScreen()}function It(e){let n,s,o,r,l,c,i;return{c(){n=b("button"),s=w("svg"),o=w("path"),r=w("path"),M(o,"d","M19.38 2.86L3.12 19.12M19.38 2.86l-1.13 5.37m1.13-5.37l-5.37 1.13M3.12 19.12l1.13-5.37m-1.13 5.37L8.5 18"),M(o,"class","fullscreen--off"),M(r,"d","M5.24 21.5l1.42-5.65m0 0L1 17.26m5.66-1.41l9.19-9.2m0 0L17.26 1m-1.41 5.66l5.66-1.42"),M(r,"class","fullscreen--on"),M(s,"viewBox","0 0 23 23"),M(s,"width","20"),M(s,"stroke-linecap","round"),M(s,"stroke-linejoin","round"),M(s,"stroke","currentColor"),M(n,"class",l="btn btn--fullscreen "+e[0])},m(t,e){v(t,n,e),$(n,s),$(s,o),$(s,r),c||(i=S(n,"click",zt),c=!0)},p(t,[e]){1&e&&l!==(l="btn btn--fullscreen "+t[0])&&M(n,"class",l)},i:t,o:t,d(t){t&&g(n),c=!1,i()}}}function jt(t,e,n){let{class:s}=e;return t.$$set=t=>{"class"in t&&n(0,s=t.class)},[s]}class At extends ct{constructor(t){super(),lt(this,t,jt,It,r,{class:0})}}function Ot(e){let n,s;return n=new At({props:{class:"header__btn"}}),{c(){nt(n.$$.fragment)},m(t,e){st(n,t,e),s=!0},p:t,i(t){s||(K(n.$$.fragment,t),s=!0)},o(t){Q(n.$$.fragment,t),s=!1},d(t){ot(n,t)}}}class Rt extends ct{constructor(t){super(),lt(this,t,null,Ot,r,{})}}function Pt(e){let n,o,r,l,c,i,a,u,d,p;return{c(){n=b("div"),o=b("input"),r=x(),l=b("div"),c=b("div"),i=x(),a=b("div"),M(o,"type","range"),M(o,"min",e[2]),M(o,"max",e[3]),M(o,"class","svelte-d8q7c5"),M(c,"class","range__track svelte-d8q7c5"),M(a,"class","range__thumb svelte-d8q7c5"),M(l,"class","range svelte-d8q7c5"),q(l,"--percent",e[4]+"%"),M(n,"class",u="wrapper "+e[1]+" svelte-d8q7c5")},m(t,s){v(t,n,s),$(n,o),N(o,e[0]),$(n,r),$(n,l),$(l,c),$(l,i),$(l,a),d||(p=[S(o,"change",e[8]),S(o,"input",e[8]),S(o,"change",e[5]),S(o,"input",e[6]),S(o,"pointerup",e[5])],d=!0)},p(t,[e]){4&e&&M(o,"min",t[2]),8&e&&M(o,"max",t[3]),1&e&&N(o,t[0]),16&e&&q(l,"--percent",t[4]+"%"),2&e&&u!==(u="wrapper "+t[1]+" svelte-d8q7c5")&&M(n,"class",u)},i:t,o:t,d(t){t&&g(n),d=!1,s(p)}}}function Jt(t,e,n){let{className:s}=e,{min:o=0}=e,{max:r=100}=e,{value:l}=e,{_value:c}=e,i=!c;i&&(c=l);const a=F();let u=0;return t.$$set=t=>{"className"in t&&n(1,s=t.className),"min"in t&&n(2,o=t.min),"max"in t&&n(3,r=t.max),"value"in t&&n(7,l=t.value),"_value"in t&&n(0,c=t._value)},t.$$.update=()=>{13&t.$$.dirty&&n(4,u=(c-o)/(r-o)*100)},[c,s,o,r,u,t=>{n(7,l=c),a("change",t)},t=>{i&&n(7,l=c),a("input",t)},l,function(){c=function(t){return""===t?null:+t}(this.value),n(0,c)}]}class Bt extends ct{constructor(t){super(),lt(this,t,Jt,Pt,r,{className:1,min:2,max:3,value:7,_value:0})}}function Wt(e){let n,s,o,r,l,c,i;return{c(){n=b("label"),s=b("input"),o=x(),r=b("div"),l=y(e[2]),M(s,"type","radio"),s.__value=e[1],s.value=s.__value,M(s,"class","radio__input svelte-1cmymy4"),e[5][0].push(s),M(r,"class","radio__label svelte-1cmymy4"),M(n,"class","radio svelte-1cmymy4"),M(n,"style",e[3])},m(t,a){v(t,n,a),$(n,s),s.checked=s.__value===e[0],$(n,o),$(n,r),$(r,l),c||(i=S(s,"change",e[4]),c=!0)},p(t,[e]){2&e&&(s.__value=t[1],s.value=s.__value),1&e&&(s.checked=s.__value===t[0]),4&e&&T(l,t[2]),8&e&&M(n,"style",t[3])},i:t,o:t,d(t){t&&g(n),e[5][0].splice(e[5][0].indexOf(s),1),c=!1,i()}}}function Zt(t,e,n){let{group:s}=e,{value:o}=e,{label:r}=e,{style:l}=e;return t.$$set=t=>{"group"in t&&n(0,s=t.group),"value"in t&&n(1,o=t.value),"label"in t&&n(2,r=t.label),"style"in t&&n(3,l=t.style)},[s,o,r,l,function(){s=this.__value,n(0,s)},[[]]]}class Dt extends ct{constructor(t){super(),lt(this,t,Zt,Wt,r,{group:0,value:1,label:2,style:3})}}function Vt(t){let e,n,s,o,r,l,c,i,a;const d=t[6].default,_=u(d,t,t[5],null);return{c(){e=b("div"),n=b("select"),_&&_.c(),o=x(),r=b("div"),l=y(t[4]),M(n,"class",s=m(t[1])+" svelte-g580vn"),void 0===t[0]&&R((()=>t[8].call(n))),M(r,"class","select svelte-g580vn"),q(r,"width",t[3]+"px"),M(e,"class","wrapper svelte-g580vn")},m(s,u){v(s,e,u),$(e,n),_&&_.m(n,null),t[7](n),C(n,t[0]),$(e,o),$(e,r),$(r,l),c=!0,i||(a=S(n,"change",t[8]),i=!0)},p(t,[e]){_&&_.p&&(!c||32&e)&&f(_,d,t,t[5],c?p(d,t[5],e,null):h(t[5]),null),(!c||2&e&&s!==(s=m(t[1])+" svelte-g580vn"))&&M(n,"class",s),1&e&&C(n,t[0]),(!c||16&e)&&T(l,t[4]),(!c||8&e)&&q(r,"width",t[3]+"px")},i(t){c||(K(_,t),c=!0)},o(t){Q(_,t),c=!1},d(n){n&&g(e),_&&_.d(n),t[7](null),i=!1,a()}}}function Xt(t,e,n){let s,o,r,{$$slots:l={},$$scope:c}=e,{className:i}=e,{value:a}=e;return t.$$set=t=>{"className"in t&&n(1,i=t.className),"value"in t&&n(0,a=t.value),"$$scope"in t&&n(5,c=t.$$scope)},t.$$.update=()=>{if(5&t.$$.dirty&&o){n(3,s=o?.offsetWidth);const t=o.querySelector(`[value="${a}"]`);n(4,r=t?t.innerText:a)}},[a,i,o,s,r,c,l,function(t){z[t?"unshift":"push"]((()=>{o=t,n(2,o)}))},function(){a=function(t){const e=t.querySelector(":checked")||t.options[0];return e&&e.__value}(this),n(0,a)}]}class Gt extends ct{constructor(t){super(),lt(this,t,Xt,Vt,r,{className:1,value:0})}}function Kt(t){let e,n,s,o,r,l,c,i,a,u,d,p=t[0].title+"",f=t[0].author+"",h=Math.floor(1e3*t[0].progress)/10+"",m=t[0].chapter&&Qt(t);return{c(){e=b("div"),n=b("p"),s=y(p),o=x(),r=b("p"),l=y(f),c=x(),m&&m.c(),i=x(),a=b("p"),u=y(h),d=y("%"),M(n,"class","book__title svelte-1aisi1b"),M(r,"class","book__author svelte-1aisi1b"),M(a,"class","book__progress svelte-1aisi1b"),M(e,"class","book svelte-1aisi1b")},m(t,p){v(t,e,p),$(e,n),$(n,s),$(e,o),$(e,r),$(r,l),$(e,c),m&&m.m(e,null),$(e,i),$(e,a),$(a,u),$(a,d)},p(t,n){1&n&&p!==(p=t[0].title+"")&&T(s,p),1&n&&f!==(f=t[0].author+"")&&T(l,f),t[0].chapter?m?m.p(t,n):(m=Qt(t),m.c(),m.m(e,i)):m&&(m.d(1),m=null),1&n&&h!==(h=Math.floor(1e3*t[0].progress)/10+"")&&T(u,h)},d(t){t&&g(e),m&&m.d()}}}function Qt(t){let e,n=t[0].chapter.innerHTML+"";return{c(){e=b("p"),M(e,"class","book__chapter svelte-1aisi1b")},m(t,s){v(t,e,s),e.innerHTML=n},p(t,s){1&s&&n!==(n=t[0].chapter.innerHTML+"")&&(e.innerHTML=n)},d(t){t&&g(e)}}}function Ut(e){let n,s,o;document.title=n=e[2];let r="book"==e[1].active&&e[0]&&e[0].inited&&Kt(e);return{c(){s=x(),r&&r.c(),o=k()},m(t,e){v(t,s,e),r&&r.m(t,e),v(t,o,e)},p(t,[e]){4&e&&n!==(n=t[2])&&(document.title=n),"book"==t[1].active&&t[0]&&t[0].inited?r?r.p(t,e):(r=Kt(t),r.c(),r.m(o.parentNode,o)):r&&(r.d(1),r=null)},i:t,o:t,d(t){t&&g(s),r&&r.d(t),t&&g(o)}}}function Yt(t,e,n){let s,o,r,l;return a(t,$t,(t=>n(1,s=t))),a(t,vt,(t=>n(3,o=t))),t.$$.update=()=>{11&t.$$.dirty&&(n(0,r=o.list[o.active]),"book"==s.active?n(2,l=`${r.title} - Reader`):n(2,l="Reader"))},[r,s,l,o]}class te extends ct{constructor(t){super(),lt(this,t,Yt,Ut,r,{})}}function ee(t,e,n){const s=t.slice();return s[18]=e[n],s}function ne(t){let e,n,s,o,r,l,c,i,a,u,d,p,f;return{c(){e=b("option"),e.textContent="Сепия",n=x(),s=b("option"),s.textContent="Сепия контарст",o=x(),r=b("option"),r.textContent="День",l=x(),c=b("option"),c.textContent="Ночь",i=x(),a=b("option"),a.textContent="Ночь контарст",u=x(),d=b("option"),d.textContent="Сумерки",p=x(),f=b("option"),f.textContent="Консоль",e.__value="sepia",e.value=e.__value,s.__value="sepia-contrast",s.value=s.__value,r.__value="day",r.value=r.__value,c.__value="night",c.value=c.__value,a.__value="night-contrast",a.value=a.__value,d.__value="dusk",d.value=d.__value,f.__value="console",f.value=f.__value},m(t,h){v(t,e,h),v(t,n,h),v(t,s,h),v(t,o,h),v(t,r,h),v(t,l,h),v(t,c,h),v(t,i,h),v(t,a,h),v(t,u,h),v(t,d,h),v(t,p,h),v(t,f,h)},d(t){t&&g(e),t&&g(n),t&&g(s),t&&g(o),t&&g(r),t&&g(l),t&&g(c),t&&g(i),t&&g(a),t&&g(u),t&&g(d),t&&g(p),t&&g(f)}}}function se(t){let e,n,s,o,r,l,c;return{c(){e=b("option"),e.textContent="Roboto Slab",n=x(),s=b("option"),s.textContent="Jura",o=x(),r=b("option"),r.textContent="Playfair Display",l=x(),c=b("option"),c.textContent="Raleway",e.__value="RobotoSlab",e.value=e.__value,s.__value="Jura",s.value=s.__value,r.__value="PlayfairDisplay",r.value=r.__value,c.__value="Raleway",c.value=c.__value},m(t,i){v(t,e,i),v(t,n,i),v(t,s,i),v(t,o,i),v(t,r,i),v(t,l,i),v(t,c,i)},d(t){t&&g(e),t&&g(n),t&&g(s),t&&g(o),t&&g(r),t&&g(l),t&&g(c)}}}function oe(t){let e,n,s;function o(e){t[16](e)}let r={value:t[18],label:"А",style:"font-weight: "+t[18]+";"};return void 0!==t[5]&&(r.group=t[5]),e=new Dt({props:r}),z.push((()=>et(e,"group",o))),{c(){nt(e.$$.fragment)},m(t,n){st(e,t,n),s=!0},p(t,s){const o={};!n&&32&s&&(n=!0,o.group=t[5],P((()=>n=!1))),e.$set(o)},i(t){s||(K(e.$$.fragment,t),s=!0)},o(t){Q(e.$$.fragment,t),s=!1},d(t){ot(e,t)}}}function re(t){let e,n,s,o,r,l,c,i,a,u,d,p,f,h,m,w,k,S,L,N,C,E,F,H,I,j,A,O,R,J,B,W,Z,D,V,U,Y,tt,rt,lt,ct,it,at,ut,dt,pt,ft,ht,mt=2*t[3]+"";function $t(e){t[10](e)}function vt(e){t[11](e)}n=new te({});let gt={className:"width__input",min:"100",max:window.innerWidth-20};function _t(e){t[12](e)}function bt(e){t[13](e)}void 0!==t[2]&&(gt.value=t[2]),void 0!==t[1]&&(gt._value=t[1]),p=new Bt({props:gt}),z.push((()=>et(p,"value",$t))),z.push((()=>et(p,"_value",vt))),p.$on("change",t[8]),p.$on("input",t[9]);let wt={className:"width__input",min:"2",max:Math.floor(window.innerHeight/(2*t[7]*1.25))};function yt(e){t[14](e)}void 0!==t[4]&&(wt.value=t[4]),void 0!==t[3]&&(wt._value=t[3]),w=new Bt({props:wt}),z.push((()=>et(w,"value",_t))),z.push((()=>et(w,"_value",bt))),w.$on("change",t[8]),w.$on("input",t[9]);let xt={className:"scheme__input",$$slots:{default:[ne]},$$scope:{ctx:t}};function kt(e){t[15](e)}void 0!==t[0]&&(xt.value=t[0]),F=new Gt({props:xt}),z.push((()=>et(F,"value",yt)));let St={className:"font__input",$$slots:{default:[se]},$$scope:{ctx:t}};void 0!==t[6]&&(St.value=t[6]),R=new Gt({props:St}),z.push((()=>et(R,"value",kt)));let Lt=[300,400,600,700],Mt=[];for(let e=0;e<4;e+=1)Mt[e]=oe(ee(t,Lt,e));const Tt=t=>Q(Mt[t],1,1,(()=>{Mt[t]=null}));function Nt(e){t[17](e)}let qt={className:"font-size__input",min:"12",max:"30"};return void 0!==t[7]&&(qt.value=t[7]),pt=new Bt({props:qt}),z.push((()=>et(pt,"value",Nt))),{c(){e=b("div"),nt(n.$$.fragment),s=x(),o=b("div"),r=b("h3"),l=y("Размер текста "),c=b("span"),i=y(t[1]),a=y("x"),u=y(mt),d=x(),nt(p.$$.fragment),m=x(),nt(w.$$.fragment),L=x(),N=b("div"),C=b("h3"),C.innerHTML="Цветовая<br/>схема",E=x(),nt(F.$$.fragment),I=x(),j=b("div"),A=b("h3"),A.textContent="Шрифт",O=x(),nt(R.$$.fragment),B=x(),W=b("div"),Z=b("h3"),D=y("Жирность "),V=b("span"),U=y(t[5]),Y=x(),tt=b("fieldset");for(let t=0;t<4;t+=1)Mt[t].c();rt=x(),lt=b("div"),ct=b("h3"),it=y("Кегль "),at=b("span"),ut=y(t[7]),dt=x(),nt(pt.$$.fragment),M(c,"class","svelte-nrlmcn"),M(r,"class","setting__title svelte-nrlmcn"),M(o,"class","settings__field svelte-nrlmcn"),M(C,"class","setting__title svelte-nrlmcn"),M(N,"class","settings__field settings__field--select svelte-nrlmcn"),M(A,"class","setting__title svelte-nrlmcn"),M(j,"class","settings__field settings__field--select svelte-nrlmcn"),M(V,"class","svelte-nrlmcn"),M(Z,"class","setting__title svelte-nrlmcn"),q(Z,"font-weight",t[5]),M(tt,"class","settings__fieldset svelte-nrlmcn"),q(tt,"font-family","var(--font-family)"),M(W,"class","settings__field svelte-nrlmcn"),M(at,"class","svelte-nrlmcn"),M(ct,"class","setting__title svelte-nrlmcn"),M(lt,"class","settings__field svelte-nrlmcn"),M(e,"class","settings popup")},m(t,f){v(t,e,f),st(n,e,null),$(e,s),$(e,o),$(o,r),$(r,l),$(r,c),$(c,i),$(c,a),$(c,u),$(o,d),st(p,o,null),$(o,m),st(w,o,null),$(e,L),$(e,N),$(N,C),$(N,E),st(F,N,null),$(e,I),$(e,j),$(j,A),$(j,O),st(R,j,null),$(e,B),$(e,W),$(W,Z),$(Z,D),$(Z,V),$(V,U),$(W,Y),$(W,tt);for(let t=0;t<4;t+=1)Mt[t].m(tt,null);$(e,rt),$(e,lt),$(lt,ct),$(ct,it),$(ct,at),$(at,ut),$(lt,dt),st(pt,lt,null),ht=!0},p(t,[e]){(!ht||2&e)&&T(i,t[1]),(!ht||8&e)&&mt!==(mt=2*t[3]+"")&&T(u,mt);const n={};!f&&4&e&&(f=!0,n.value=t[2],P((()=>f=!1))),!h&&2&e&&(h=!0,n._value=t[1],P((()=>h=!1))),p.$set(n);const s={};128&e&&(s.max=Math.floor(window.innerHeight/(2*t[7]*1.25))),!k&&16&e&&(k=!0,s.value=t[4],P((()=>k=!1))),!S&&8&e&&(S=!0,s._value=t[3],P((()=>S=!1))),w.$set(s);const o={};2097152&e&&(o.$$scope={dirty:e,ctx:t}),!H&&1&e&&(H=!0,o.value=t[0],P((()=>H=!1))),F.$set(o);const r={};if(2097152&e&&(r.$$scope={dirty:e,ctx:t}),!J&&64&e&&(J=!0,r.value=t[6],P((()=>J=!1))),R.$set(r),(!ht||32&e)&&T(U,t[5]),(!ht||32&e)&&q(Z,"font-weight",t[5]),32&e){let n;for(Lt=[300,400,600,700],n=0;n<4;n+=1){const s=ee(t,Lt,n);Mt[n]?(Mt[n].p(s,e),K(Mt[n],1)):(Mt[n]=oe(s),Mt[n].c(),K(Mt[n],1),Mt[n].m(tt,null))}for(X(),n=4;n<4;n+=1)Tt(n);G()}(!ht||128&e)&&T(ut,t[7]);const l={};!ft&&128&e&&(ft=!0,l.value=t[7],P((()=>ft=!1))),pt.$set(l)},i(t){if(!ht){K(n.$$.fragment,t),K(p.$$.fragment,t),K(w.$$.fragment,t),K(F.$$.fragment,t),K(R.$$.fragment,t);for(let t=0;t<4;t+=1)K(Mt[t]);K(pt.$$.fragment,t),ht=!0}},o(t){Q(n.$$.fragment,t),Q(p.$$.fragment,t),Q(w.$$.fragment,t),Q(F.$$.fragment,t),Q(R.$$.fragment,t),Mt=Mt.filter(Boolean);for(let t=0;t<4;t+=1)Q(Mt[t]);Q(pt.$$.fragment,t),ht=!1},d(t){t&&g(e),ot(n),ot(p),ot(w),ot(F),ot(R),_(Mt,t),ot(pt)}}}function le(t,e,n){let s=mt.get("scheme"),o=mt.get("book-width-tmp"),r=mt.get("book-width"),l=mt.get("book-height-tmp"),c=mt.get("book-height"),i=mt.get("font-weight"),a=mt.get("font-family"),u=mt.get("font-size");return t.$$.update=()=>{1&t.$$.dirty&&mt.add("scheme",s),4&t.$$.dirty&&mt.add("book-width",r),2&t.$$.dirty&&mt.add("book-width-tmp",o),8&t.$$.dirty&&mt.add("book-height-tmp",l),16&t.$$.dirty&&mt.add("book-height",c),32&t.$$.dirty&&mt.add("font-weight",i),64&t.$$.dirty&&mt.add("font-family",a),128&t.$$.dirty&&mt.add("font-size",u)},[s,o,r,l,c,i,a,u,t=>{t.detail,document.body.classList.remove("size-changing")},t=>{t.detail,document.body.classList.add("size-changing")},function(t){r=t,n(2,r)},function(t){o=t,n(1,o)},function(t){c=t,n(4,c)},function(t){l=t,n(3,l)},function(t){s=t,n(0,s)},function(t){a=t,n(6,a)},function(t){i=t,n(5,i)},function(t){u=t,n(7,u)}]}class ce extends ct{constructor(t){super(),lt(this,t,le,re,r,{})}}function ie(t,e,n){const s=t.slice();return s[3]=e[n],s}function ae(t){let e,n,s,o,r,l=t[0].title+"",c=t[0].chapters,i=[];for(let e=0;e<c.length;e+=1)i[e]=ue(ie(t,c,e));return{c(){e=b("div"),n=b("h2"),s=y(l),o=x(),r=b("ul");for(let t=0;t<i.length;t+=1)i[t].c();M(n,"class","svelte-xednov"),M(r,"class","chapters__list svelte-xednov"),M(e,"class","chapters popup")},m(t,l){v(t,e,l),$(e,n),$(n,s),$(e,o),$(e,r);for(let t=0;t<i.length;t+=1)i[t].m(r,null)},p(t,e){if(1&e&&l!==(l=t[0].title+"")&&T(s,l),3&e){let n;for(c=t[0].chapters,n=0;n<c.length;n+=1){const s=ie(t,c,n);i[n]?i[n].p(s,e):(i[n]=ue(s),i[n].c(),i[n].m(r,null))}for(;n<i.length;n+=1)i[n].d(1);i.length=c.length}},d(t){t&&g(e),_(i,t)}}}function ue(t){let e,n,s,r,l,c,i=t[3].innerText+"";return{c(){e=b("li"),n=b("button"),s=y(i),r=x(),M(n,"class","chapters__btn svelte-xednov"),M(e,"class","chapters__item")},m(i,a){v(i,e,a),$(e,n),$(n,s),$(e,r),l||(c=S(n,"click",(function(){o(t[1].bind(t[3]))&&t[1].bind(t[3]).apply(this,arguments)})),l=!0)},p(e,n){t=e,1&n&&i!==(i=t[3].innerText+"")&&T(s,i)},d(t){t&&g(e),l=!1,c()}}}function de(e){let n,s=e[0]&&e[0].inited&&e[0].chapters.length&&ae(e);return{c(){s&&s.c(),n=k()},m(t,e){s&&s.m(t,e),v(t,n,e)},p(t,[e]){t[0]&&t[0].inited&&t[0].chapters.length?s?s.p(t,e):(s=ae(t),s.c(),s.m(n.parentNode,n)):s&&(s.d(1),s=null)},i:t,o:t,d(t){s&&s.d(t),t&&g(n)}}}function pe(t,e,n){let s,o;return a(t,vt,(t=>n(2,s=t))),t.$$.update=()=>{4&t.$$.dirty&&n(0,o=s.list[s.active])},[o,function(){o.showChapter(this),n(0,o.chapter=this,o)},s]}class fe extends ct{constructor(t){super(),lt(this,t,pe,de,r,{})}}function he(e){let n,s,o,r,l,c,i,a,u,d,p,f,h;return o=new Ht({}),c=new Rt({}),u=new ce({}),f=new fe({}),{c(){n=b("header"),s=b("div"),nt(o.$$.fragment),r=x(),l=b("div"),nt(c.$$.fragment),i=x(),a=b("div"),nt(u.$$.fragment),d=x(),p=b("div"),nt(f.$$.fragment),M(s,"class","header__controls svelte-1q5vita"),M(l,"class","header__controls svelte-1q5vita"),M(a,"class","header__settings popup-wrapper"),M(p,"class","header__chapters popup-wrapper"),M(n,"class","header svelte-1q5vita")},m(t,e){v(t,n,e),$(n,s),st(o,s,null),$(n,r),$(n,l),st(c,l,null),$(n,i),$(n,a),st(u,a,null),$(n,d),$(n,p),st(f,p,null),h=!0},p:t,i(t){h||(K(o.$$.fragment,t),K(c.$$.fragment,t),K(u.$$.fragment,t),K(f.$$.fragment,t),h=!0)},o(t){Q(o.$$.fragment,t),Q(c.$$.fragment,t),Q(u.$$.fragment,t),Q(f.$$.fragment,t),h=!1},d(t){t&&g(n),ot(o),ot(c),ot(u),ot(f)}}}class me extends ct{constructor(t){super(),lt(this,t,null,he,r,{})}}function $e(t){let e,n,s;const o=t[3].default,r=u(o,t,t[2],null);return{c(){e=b("div"),r&&r.c(),M(e,"class",n="screen screen--"+t[0]+" "+(t[0]==t[1].active?"screen--active":"")+" svelte-1pwbfoa")},m(t,n){v(t,e,n),r&&r.m(e,null),s=!0},p(t,[l]){r&&r.p&&(!s||4&l)&&f(r,o,t,t[2],s?p(o,t[2],l,null):h(t[2]),null),(!s||3&l&&n!==(n="screen screen--"+t[0]+" "+(t[0]==t[1].active?"screen--active":"")+" svelte-1pwbfoa"))&&M(e,"class",n)},i(t){s||(K(r,t),s=!0)},o(t){Q(r,t),s=!1},d(t){t&&g(e),r&&r.d(t)}}}function ve(t,e,n){let s;a(t,$t,(t=>n(1,s=t)));let{$$slots:o={},$$scope:r}=e,{name:l}=e;return t.$$set=t=>{"name"in t&&n(0,l=t.name),"$$scope"in t&&n(2,r=t.$$scope)},[l,s,r,o]}class ge extends ct{constructor(t){super(),lt(this,t,ve,$e,r,{name:0})}}const _e={v:"p",poem:"div",stanza:"div",emphasis:"em",description:"div","empty-line":"br",epigraph:"div","text-author":"p",cite:"div"};class be extends class{constructor(t){this.id=t,this.chapters=[],this.progress=this._getFromLocalStorage().progress||0}open(){setTimeout((()=>{this.element.parentNode.scrollTop=this.progress*this.element.offsetHeight}),1)}_getFromLocalStorage(){const t=localStorage.getItem("books")??"{}",e=JSON.parse(t);return e[this.id]||(e[this.id]={}),e[this.id]}_saveToLocalStorage(t){const e=localStorage.getItem("books")??"{}",n=JSON.parse(e);n[this.id]=t;const s=JSON.stringify(n);localStorage.setItem("books",s)}scrollToChapter(t){}_curentChapter(t){let e;for(const n in this.chapters){if(this.chapters[n].offsetTop>t){e=0==n?this.chapters[0]:this.chapters[n-1];break}}this.chapter=e||this.chapters[this.chapters.length-1]}setProgress(t,e){this.progress=t/e,this.chapters.length&&this._curentChapter(t)}set progress(t){this._progress=t;const e=this._getFromLocalStorage();e.progress=t,this._saveToLocalStorage(e)}get progress(){return this._progress}}{constructor(t,e){super(e),this.data=t,this.element=this.bookFromXML(t),this.author=this._getAuthor(),this.cover=this._getCover(),this.title=this._getTitle()}bookFromXML(t){const e=document.createElement("div");return e.innerHTML=t,e.innerHTML=e.querySelector("fictionbook").innerHTML,e.className="book__container",e.dataset.book=this.id,this._headings(e),this._tags(e),e}_getAuthor(){const t=this.element.querySelector("author");return Array.from(t.children).map((t=>t.innerText)).join(" ")}_getTitle(){return this.element.querySelector("book-title").innerText}_getCover(){const t=this.element.querySelector('binary[id="cover.jpg"]');if(!t)return null;const e=`data:${t.getAttribute("content-type")};base64,${t.innerHTML}`;return t.remove(),e}_headings(t){t.querySelectorAll("title").forEach((t=>{const e="h"+parseInt(["section"].indexOf(t.parentElement.tagName.toLocaleLowerCase())+3),n=document.createElement(e);n.innerHTML=t.innerText.trim(),n.innerHTML="h3"==e?n.innerText.trim():n.innerText,t.replaceWith(n)})),this.chapters=t.querySelectorAll("h3")}_tags(t){Object.entries(_e).forEach((([e,n])=>{const s=n.split(".");t.querySelectorAll(e).forEach((t=>{const n=document.createElement(s[0]);n.className=e,n.innerHTML=t.innerHTML,t.replaceWith(n)}))}))}}function we(e){let n,s,o,r,l,c,i,a,u;return{c(){n=b("article"),s=b("div"),o=x(),r=b("div"),l=x(),c=b("div"),M(s,"class","book__page svelte-1uxbrw8"),M(r,"class","book__border book__border--top svelte-1uxbrw8"),M(c,"class","book__border book__border--bottom svelte-1uxbrw8"),M(n,"class",i="book "+(e[2].active==e[0]?"book--active":"")+" svelte-1uxbrw8"),q(n,"--line-height",ye)},m(t,i){v(t,n,i),$(n,s),$(n,o),$(n,r),$(n,l),$(n,c),e[6](n),a||(u=S(n,"scroll",e[3]),a=!0)},p(t,[e]){5&e&&i!==(i="book "+(t[2].active==t[0]?"book--active":"")+" svelte-1uxbrw8")&&M(n,"class",i)},i:t,o:t,d(t){t&&g(n),e[6](null),a=!1,u()}}}let ye=1.25;function xe(t,e,n){let s,o;a(t,mt,(t=>n(7,s=t))),a(t,vt,(t=>n(2,o=t)));let r,l,c,{id:i}=e;const u=t=>{const e=window.innerHeight-2*s["book-height"]*s["font-size"]*ye;n(1,c.scrollTop=t.offsetTop-e/2,c)};return t.$$set=t=>{"id"in t&&n(0,i=t.id)},t.$$.update=()=>{55&t.$$.dirty&&(n(5,l=o.list[i]),l&&c&&!l.inited&&(n(4,r=new be(l.data,i)),n(4,r.showChapter=u,r),n(4,r.inited=!0,r),vt.add(i,r),c.appendChild(r.element),r.open()))},[i,c,o,function(){r.setProgress(c.scrollTop,c.scrollHeight),vt.add(i,r)},r,l,function(t){z[t?"unshift":"push"]((()=>{c=t,n(1,c)}))}]}class ke extends ct{constructor(t){super(),lt(this,t,xe,we,r,{id:0})}}function Se(t,e,n){const s=t.slice();return s[2]=e[n],s}function Le(t,e){let n,s,o;return s=new ke({props:{id:e[2]}}),{key:t,first:null,c(){n=k(),nt(s.$$.fragment),this.first=n},m(t,e){v(t,n,e),st(s,t,e),o=!0},p(t,n){e=t;const o={};1&n&&(o.id=e[2]),s.$set(o)},i(t){o||(K(s.$$.fragment,t),o=!0)},o(t){Q(s.$$.fragment,t),o=!1},d(t){t&&g(n),ot(s,t)}}}function Me(t){let e,n,s=[],o=new Map,r=t[0];const l=t=>t[2];for(let e=0;e<r.length;e+=1){let n=Se(t,r,e),c=l(n);o.set(c,s[e]=Le(c,n))}return{c(){for(let t=0;t<s.length;t+=1)s[t].c();e=k()},m(t,o){for(let e=0;e<s.length;e+=1)s[e].m(t,o);v(t,e,o),n=!0},p(t,n){1&n&&(r=t[0],X(),s=tt(s,n,l,1,t,r,o,e.parentNode,Y,Le,e,Se),G())},i(t){if(!n){for(let t=0;t<r.length;t+=1)K(s[t]);n=!0}},o(t){for(let t=0;t<s.length;t+=1)Q(s[t]);n=!1},d(t){for(let e=0;e<s.length;e+=1)s[e].d(t);t&&g(e)}}}function Te(t){let e,n;return e=new ge({props:{name:"book",$$slots:{default:[Me]},$$scope:{ctx:t}}}),{c(){nt(e.$$.fragment)},m(t,s){st(e,t,s),n=!0},p(t,[n]){const s={};33&n&&(s.$$scope={dirty:n,ctx:t}),e.$set(s)},i(t){n||(K(e.$$.fragment,t),n=!0)},o(t){Q(e.$$.fragment,t),n=!1},d(t){ot(e,t)}}}function Ne(t,e,n){let s;a(t,vt,(t=>n(1,s=t)));let o=[];return t.$$.update=()=>{2&t.$$.dirty&&s.listId&&n(0,o=s.listId)},[o,s]}class qe extends ct{constructor(t){super(),lt(this,t,Ne,Te,r,{})}}function Ce(t){let e,n,s,o,r,l,c,i,a,u,d,p,f,h,m,_=Math.floor(10*t[4])/10+"",w=t[5]&&Ee(t);return{c(){e=b("article"),n=b("div"),s=b("h3"),o=y(t[2]),r=x(),l=b("p"),c=y(t[3]),i=x(),a=b("div"),u=y(_),d=y("%\r\n\t\t\t\t"),p=b("div"),f=x(),w&&w.c(),M(s,"class","book-preview__title svelte-1eod96l"),M(l,"class","book-preview__author svelte-1eod96l"),M(p,"class","progress__bar svelte-1eod96l"),M(a,"class","book-preview__progress svelte-1eod96l"),q(a,"--progress",t[4]+"%"),M(n,"class","book-preview__description svelte-1eod96l"),M(e,"class","book-preview svelte-1eod96l"),M(e,"data-book",t[0])},m(g,_){v(g,e,_),$(e,n),$(n,s),$(s,o),$(n,r),$(n,l),$(l,c),$(n,i),$(n,a),$(a,u),$(a,d),$(a,p),$(e,f),w&&w.m(e,null),h||(m=S(e,"click",t[6]),h=!0)},p(t,n){4&n&&T(o,t[2]),8&n&&T(c,t[3]),16&n&&_!==(_=Math.floor(10*t[4])/10+"")&&T(u,_),16&n&&q(a,"--progress",t[4]+"%"),t[5]?w?w.p(t,n):(w=Ee(t),w.c(),w.m(e,null)):w&&(w.d(1),w=null),1&n&&M(e,"data-book",t[0])},d(t){t&&g(e),w&&w.d(),h=!1,m()}}}function Ee(t){let e,n;return{c(){e=b("img"),M(e,"class","book-preview__cover svelte-1eod96l"),i(e.src,n=t[5])||M(e,"src",n),M(e,"alt",t[2])},m(t,n){v(t,e,n)},p(t,s){32&s&&!i(e.src,n=t[5])&&M(e,"src",n),4&s&&M(e,"alt",t[2])},d(t){t&&g(e)}}}function Fe(e){let n,s=e[1]&&e[1].inited&&Ce(e);return{c(){s&&s.c(),n=k()},m(t,e){s&&s.m(t,e),v(t,n,e)},p(t,[e]){t[1]&&t[1].inited?s?s.p(t,e):(s=Ce(t),s.c(),s.m(n.parentNode,n)):s&&(s.d(1),s=null)},i:t,o:t,d(t){s&&s.d(t),t&&g(n)}}}function He(t,e,n){let s;a(t,vt,(t=>n(7,s=t)));let o,r,l,c,i,{id:u}=e;return t.$$set=t=>{"id"in t&&n(0,u=t.id)},t.$$.update=()=>{131&t.$$.dirty&&(n(1,o=s.list[u]),o&&o.inited&&(n(2,r=o.title),n(3,l=o.author),n(4,c=100*o.progress),n(5,i=o.cover)))},[u,o,r,l,c,i,t=>{$t.active="book",vt.active=u,o.open()},s]}class ze extends ct{constructor(t){super(),lt(this,t,He,Fe,r,{id:0})}}function Ie(t,e,n){const s=t.slice();return s[1]=e[n],s}function je(t,e){let n,s,o;return s=new ze({props:{id:e[1]}}),{key:t,first:null,c(){n=b("li"),nt(s.$$.fragment),this.first=n},m(t,e){v(t,n,e),st(s,n,null),o=!0},p(t,n){e=t;const o={};1&n&&(o.id=e[1]),s.$set(o)},i(t){o||(K(s.$$.fragment,t),o=!0)},o(t){Q(s.$$.fragment,t),o=!1},d(t){t&&g(n),ot(s)}}}function Ae(t){let e,n,s=[],o=new Map,r=t[0];const l=t=>t[1];for(let e=0;e<r.length;e+=1){let n=Ie(t,r,e),c=l(n);o.set(c,s[e]=je(c,n))}return{c(){e=b("ul");for(let t=0;t<s.length;t+=1)s[t].c();M(e,"class","book-list svelte-198p58u")},m(t,o){v(t,e,o);for(let t=0;t<s.length;t+=1)s[t].m(e,null);n=!0},p(t,[n]){1&n&&(r=t[0],X(),s=tt(s,n,l,1,t,r,o,e,Y,je,null,Ie),G())},i(t){if(!n){for(let t=0;t<r.length;t+=1)K(s[t]);n=!0}},o(t){for(let t=0;t<s.length;t+=1)Q(s[t]);n=!1},d(t){t&&g(e);for(let t=0;t<s.length;t+=1)s[t].d()}}}function Oe(t,e,n){let{list:s}=e;return t.$$set=t=>{"list"in t&&n(0,s=t.list)},[s]}class Re extends ct{constructor(t){super(),lt(this,t,Oe,Ae,r,{list:0})}}function Pe(e){let n,s,o,r,l,c,i;return{c(){n=b("div"),s=b("label"),o=b("h1"),o.textContent="Выберите файлы",r=x(),l=b("input"),M(o,"class","drag__title svelte-ppk8qd"),M(l,"type","file"),M(l,"class","drag__input svelte-ppk8qd"),M(l,"accept",".fb2"),l.multiple=!0,M(s,"class","drag svelte-ppk8qd"),M(n,"class","wrapper svelte-ppk8qd")},m(t,a){v(t,n,a),$(n,s),$(s,o),$(s,r),$(s,l),c||(i=S(l,"input",e[0]),c=!0)},p:t,i:t,o:t,d(t){t&&g(n),c=!1,i()}}}function Je(t){return[t=>vt.addFiles(t.target.files)]}class Be extends ct{constructor(t){super(),lt(this,t,Je,Pe,r,{})}}function We(e){let n;return{c(){n=b("div"),n.innerHTML='<div class="dropper__area svelte-ci4cx1"><h1>Drop</h1></div>',M(n,"class","dropper svelte-ci4cx1")},m(t,e){v(t,n,e)},p:t,i:t,o:t,d(t){t&&g(n)}}}class Ze extends ct{constructor(t){super(),lt(this,t,null,We,r,{})}}const{document:De}=U;function Ve(e){let n,s;return n=new Be({}),{c(){nt(n.$$.fragment)},m(t,e){st(n,t,e),s=!0},p:t,i(t){s||(K(n.$$.fragment,t),s=!0)},o(t){Q(n.$$.fragment,t),s=!1},d(t){ot(n,t)}}}function Xe(t){let e,n,s,o;return e=new Re({props:{list:t[0].listId}}),s=new Ze({}),{c(){nt(e.$$.fragment),n=x(),nt(s.$$.fragment)},m(t,r){st(e,t,r),v(t,n,r),st(s,t,r),o=!0},p(t,n){const s={};1&n&&(s.list=t[0].listId),e.$set(s)},i(t){o||(K(e.$$.fragment,t),K(s.$$.fragment,t),o=!0)},o(t){Q(e.$$.fragment,t),Q(s.$$.fragment,t),o=!1},d(t){ot(e,t),t&&g(n),ot(s,t)}}}function Ge(t){let e,n,s,o;const r=[Xe,Ve],l=[];function c(t,e){return t[0].listId?0:1}return e=c(t),n=l[e]=r[e](t),{c(){n.c(),s=k()},m(t,n){l[e].m(t,n),v(t,s,n),o=!0},p(t,o){let i=e;e=c(t),e===i?l[e].p(t,o):(X(),Q(l[i],1,1,(()=>{l[i]=null})),G(),n=l[e],n?n.p(t,o):(n=l[e]=r[e](t),n.c()),K(n,1),n.m(s.parentNode,s))},i(t){o||(K(n),o=!0)},o(t){Q(n),o=!1},d(t){l[e].d(t),t&&g(s)}}}function Ke(t){let e,n,o,r,l;return n=new ge({props:{name:"home",$$slots:{default:[Ge]},$$scope:{ctx:t}}}),{c(){e=x(),nt(n.$$.fragment)},m(s,c){v(s,e,c),st(n,s,c),o=!0,r||(l=[S(De.body,"dragover",L(Qe)),S(De.body,"dragleave",L(Ue)),S(De.body,"drop",L(t[1]))],r=!0)},p(t,[e]){const s={};5&e&&(s.$$scope={dirty:e,ctx:t}),n.$set(s)},i(t){o||(K(n.$$.fragment,t),o=!0)},o(t){Q(n.$$.fragment,t),o=!1},d(t){t&&g(e),ot(n,t),r=!1,s(l)}}}function Qe(){document.body.classList.add("drag--active")}function Ue(){document.body.classList.remove("drag--active")}function Ye(t,e,n){let s;return a(t,vt,(t=>n(0,s=t))),[s,function(t){document.body.classList.remove("drag--active"),vt.addFiles(t.dataTransfer.files)}]}class tn extends ct{constructor(t){super(),lt(this,t,Ye,Ke,r,{})}}function en(t){let e,n,s,o,r,l,c,i;return n=new me({}),o=new tn({}),l=new qe({}),{c(){e=b("main"),nt(n.$$.fragment),s=x(),nt(o.$$.fragment),r=x(),nt(l.$$.fragment),M(e,"class",c="theme--"+t[0].scheme)},m(t,c){v(t,e,c),st(n,e,null),$(e,s),st(o,e,null),$(e,r),st(l,e,null),i=!0},p(t,[n]){(!i||1&n&&c!==(c="theme--"+t[0].scheme))&&M(e,"class",c)},i(t){i||(K(n.$$.fragment,t),K(o.$$.fragment,t),K(l.$$.fragment,t),i=!0)},o(t){Q(n.$$.fragment,t),Q(o.$$.fragment,t),Q(l.$$.fragment,t),i=!1},d(t){t&&g(e),ot(n),ot(o),ot(l)}}}function nn(t,e,n){let s;return a(t,mt,(t=>n(0,s=t))),[s]}return new class extends ct{constructor(t){super(),lt(this,t,nn,en,r,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
