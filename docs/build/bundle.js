var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function s(t){t.forEach(e)}function r(t){return"function"==typeof t}function o(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}let l,c;function i(t,e){return l||(l=document.createElement("a")),l.href=e,t===l.href}function a(e,n,s){e.$$.on_destroy.push(function(e,...n){if(null==e)return t;const s=e.subscribe(...n);return s.unsubscribe?()=>s.unsubscribe():s}(n,s))}function u(t,e,n,s){if(t){const r=d(t,e,n,s);return t[0](r)}}function d(t,e,n,s){return t[1]&&s?function(t,e){for(const n in e)t[n]=e[n];return t}(n.ctx.slice(),t[1](s(e))):n.ctx}function p(t,e,n,s){if(t[2]&&s){const r=t[2](s(n));if(void 0===e.dirty)return r;if("object"==typeof r){const t=[],n=Math.max(e.dirty.length,r.length);for(let s=0;s<n;s+=1)t[s]=e.dirty[s]|r[s];return t}return e.dirty|r}return e.dirty}function f(t,e,n,s,r,o){if(r){const l=d(e,n,s,o);t.p(l,r)}}function h(t){if(t.ctx.length>32){const e=[],n=t.ctx.length/32;for(let t=0;t<n;t++)e[t]=-1;return e}return-1}function m(t){return null==t?"":t}function $(t,e){t.appendChild(e)}function v(t,e,n){t.insertBefore(e,n||null)}function g(t){t.parentNode.removeChild(t)}function _(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function b(t){return document.createElement(t)}function y(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function w(t){return document.createTextNode(t)}function x(){return w(" ")}function k(){return w("")}function S(t,e,n,s){return t.addEventListener(e,n,s),()=>t.removeEventListener(e,n,s)}function M(t){return function(e){return e.preventDefault(),t.call(this,e)}}function L(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function q(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function T(t,e){t.value=null==e?"":e}function N(t,e,n,s){t.style.setProperty(e,n,s?"important":"")}function C(t,e){for(let n=0;n<t.options.length;n+=1){const s=t.options[n];if(s.__value===e)return void(s.selected=!0)}t.selectedIndex=-1}function E(t){c=t}function F(){const t=function(){if(!c)throw new Error("Function called outside component initialization");return c}();return(e,n)=>{const s=t.$$.callbacks[e];if(s){const r=function(t,e,n=!1){const s=document.createEvent("CustomEvent");return s.initCustomEvent(t,n,!1,e),s}(e,n);s.slice().forEach((e=>{e.call(t,r)}))}}}const H=[],z=[],j=[],I=[],O=Promise.resolve();let A=!1;function R(t){j.push(t)}function P(t){I.push(t)}let B=!1;const J=new Set;function W(){if(!B){B=!0;do{for(let t=0;t<H.length;t+=1){const e=H[t];E(e),Z(e.$$)}for(E(null),H.length=0;z.length;)z.pop()();for(let t=0;t<j.length;t+=1){const e=j[t];J.has(e)||(J.add(e),e())}j.length=0}while(H.length);for(;I.length;)I.pop()();A=!1,B=!1,J.clear()}}function Z(t){if(null!==t.fragment){t.update(),s(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(R)}}const D=new Set;let V;function X(){V={r:0,c:[],p:V}}function G(){V.r||s(V.c),V=V.p}function K(t,e){t&&t.i&&(D.delete(t),t.i(e))}function Q(t,e,n,s){if(t&&t.o){if(D.has(t))return;D.add(t),V.c.push((()=>{D.delete(t),s&&(n&&t.d(1),s())})),t.o(e)}}const U="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;function Y(t,e){Q(t,1,1,(()=>{e.delete(t.key)}))}function tt(t,e,n,s,r,o,l,c,i,a,u,d){let p=t.length,f=o.length,h=p;const m={};for(;h--;)m[t[h].key]=h;const $=[],v=new Map,g=new Map;for(h=f;h--;){const t=d(r,o,h),c=n(t);let i=l.get(c);i?s&&i.p(t,e):(i=a(c,t),i.c()),v.set(c,$[h]=i),c in m&&g.set(c,Math.abs(h-m[c]))}const _=new Set,b=new Set;function y(t){K(t,1),t.m(c,u),l.set(t.key,t),u=t.first,f--}for(;p&&f;){const e=$[f-1],n=t[p-1],s=e.key,r=n.key;e===n?(u=e.first,p--,f--):v.has(r)?!l.has(s)||_.has(s)?y(e):b.has(r)?p--:g.get(s)>g.get(r)?(b.add(s),y(e)):(_.add(r),p--):(i(n,l),p--)}for(;p--;){const e=t[p];v.has(e.key)||i(e,l)}for(;f;)y($[f-1]);return $}function et(t,e,n){const s=t.$$.props[e];void 0!==s&&(t.$$.bound[s]=n,n(t.$$.ctx[s]))}function nt(t){t&&t.c()}function st(t,n,o,l){const{fragment:c,on_mount:i,on_destroy:a,after_update:u}=t.$$;c&&c.m(n,o),l||R((()=>{const n=i.map(e).filter(r);a?a.push(...n):s(n),t.$$.on_mount=[]})),u.forEach(R)}function rt(t,e){const n=t.$$;null!==n.fragment&&(s(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function ot(t,e){-1===t.$$.dirty[0]&&(H.push(t),A||(A=!0,O.then(W)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function lt(e,r,o,l,i,a,u,d=[-1]){const p=c;E(e);const f=e.$$={fragment:null,ctx:null,props:a,update:t,not_equal:i,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(p?p.$$.context:r.context||[]),callbacks:n(),dirty:d,skip_bound:!1,root:r.target||p.$$.root};u&&u(f.root);let h=!1;if(f.ctx=o?o(e,r.props||{},((t,n,...s)=>{const r=s.length?s[0]:n;return f.ctx&&i(f.ctx[t],f.ctx[t]=r)&&(!f.skip_bound&&f.bound[t]&&f.bound[t](r),h&&ot(e,t)),n})):[],f.update(),h=!0,s(f.before_update),f.fragment=!!l&&l(f.ctx),r.target){if(r.hydrate){const t=function(t){return Array.from(t.childNodes)}(r.target);f.fragment&&f.fragment.l(t),t.forEach(g)}else f.fragment&&f.fragment.c();r.intro&&K(e.$$.fragment),st(e,r.target,r.anchor,r.customElement),W()}E(p)}class ct{$destroy(){rt(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const it=[];class at{constructor(e){this.writable=function(e,n=t){let s;const r=new Set;function l(t){if(o(e,t)&&(e=t,s)){const t=!it.length;for(const t of r)t[1](),it.push(t,e);if(t){for(let t=0;t<it.length;t+=2)it[t][0](it[t+1]);it.length=0}}}return{set:l,update:function(t){l(t(e))},subscribe:function(o,c=t){const i=[o,c];return r.add(i),1===r.size&&(s=n(l)||t),o(e),()=>{r.delete(i),0===r.size&&(s(),s=null)}}}}(e),this.subscribe=this.writable.subscribe,this.set=this.writable.set}add(t,e){this.writable.update((n=>(n[t]=e,n)))}get(){let t;return this.writable.update((e=>(t=e,e))),t}}let ut,dt;const pt=Math.min(Math.floor(.9*innerWidth),544),ft=`{\n\t"scheme": "sepia",\n\t"book-width": ${pt},\n\t"book-width-tmp": ${pt},\n\t"book-height-tmp": 4,\n\t"book-height": 4,\n\t"font-weight": 400,\n\t"font-family": "RobotoSlab",\n\t"font-size": 16\n}`,ht=localStorage.getItem("theme")||ft;let mt=new class extends at{constructor(){super(JSON.parse(ht))}get(t){return super.get()[t]}add(t,e){super.add(t,e),document.body.style.setProperty(`--${t}`,"string"==typeof e?`"${e}"`:e),localStorage.setItem("theme",JSON.stringify(super.get()))}},$t=new class extends at{constructor(){super({}),this.active="home",this.prevent="home",ut=this}set active(t){this._active=t,this.add("active",t)}get active(){return this._active}get prevent(){return this._prevent}set prevent(t){this._prevent=t,this.add("prevent",t)}toPrevent(){[ut.active,ut.prevent]=[ut.prevent,ut.active],ut.active==ut.prevent&&"book"==ut.active&&(ut.active="home")}},vt=new class extends at{constructor(){super({listId:[]}),this._list={},dt=this,this.set({list:Object.keys(this._list)})}addFiles(t){for(const e of t){const t=e.name;if(!e.name.endsWith(".fb2")){console.log(t+" not fictionbook");continue}const n=new FileReader;n.readAsText(e),n.onload=e=>{const s=n.result;this.add(t,{data:s,inited:!1})}}}async update(){[...(await fetch("books.txt").then((t=>t.text()))).split("\n")].map((t=>t.trim())).forEach((async t=>{const e=await fetch("books/"+t).then((t=>t.text()));dt.add(t,{data:e,inited:!1})}))}get active(){return this._active}set active(t){this._active=t,super.add("active",t)}add(t,e){this._list[t]=e,super.add("list",this._list),super.add("listId",Object.keys(this._list))}};function gt(e){let n,s,r,o,l,c;return{c(){n=b("button"),s=y("svg"),r=y("path"),L(r,"d","M0 3l5 2.9V0L0 3zm16.5-.5h-12v1h12v-1z"),L(s,"viewBox","0 0 17 6.5"),L(s,"width","17"),L(n,"class",o="btn btn--back "+e[0])},m(t,e){v(t,n,e),$(n,s),$(s,r),l||(c=S(n,"click",$t.toPrevent),l=!0)},p(t,[e]){1&e&&o!==(o="btn btn--back "+t[0])&&L(n,"class",o)},i:t,o:t,d(t){t&&g(n),l=!1,c()}}}function _t(t,e,n){let{class:s}=e;return t.$$set=t=>{"class"in t&&n(0,s=t.class)},[s]}class bt extends ct{constructor(t){super(),lt(this,t,_t,gt,o,{class:0})}}function yt(e){let n,r,o,l,c,i;return{c(){n=b("button"),r=y("svg"),o=y("path"),L(o,"d","M13.3 8.5V7l1.6-1.2c.1-.2.2-.3 0-.5l-1.4-2.6c-.1-.2-.3-.2-.5-.2l-1.9.8-1.2-.8-.3-2a.4.4 0 00-.4-.2h-3a.4.4 0 00-.4.3l-.2 2a6 6 0 00-1.3.7l-1.9-.8a.4.4 0 00-.4.2L.5 5.3a.4.4 0 000 .5L2.2 7v1.5L.6 9.7a.4.4 0 000 .5L2 12.8c0 .2.3.2.5.2l1.8-.8 1.3.8.3 2 .4.2h3c.1 0 .3-.1.3-.3l.3-2c.5-.1.9-.4 1.3-.7l1.8.8c.2 0 .4 0 .5-.2l1.5-2.6v-.5l-1.7-1.2zm-5.6 1.9a2.6 2.6 0 110-5.3 2.6 2.6 0 010 5.3z"),L(r,"viewBox","0 0 16 16"),L(r,"width","16"),L(n,"class",l="btn btn--settings "+e[0])},m(t,s){v(t,n,s),$(n,r),$(r,o),c||(i=[S(n,"mouseout",e[2]),S(n,"mouseover",e[1])],c=!0)},p(t,[e]){1&e&&l!==(l="btn btn--settings "+t[0])&&L(n,"class",l)},i:t,o:t,d(t){t&&g(n),c=!1,s(i)}}}function wt(t,e,n){let{class:s}=e;return t.$$set=t=>{"class"in t&&n(0,s=t.class)},[s,()=>{document.querySelector(".header__settings").classList.add("popup-wrapper--active")},()=>{document.querySelector(".header__settings").classList.remove("popup-wrapper--active")}]}class xt extends ct{constructor(t){super(),lt(this,t,wt,yt,o,{class:0})}}function kt(e){let n,r,o,l,c,i;return{c(){n=b("button"),r=y("svg"),o=y("path"),L(o,"d","M4 1a1 1 0 0 1 1-1h13a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V1ZM4 6a1 1 0 0 1 1-1h13a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V6ZM4 11a1 1 0 0 1 1-1h13a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-1ZM3 1.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0ZM3 6.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0ZM3 11.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0Z"),L(r,"viewBox","0 0 19 13"),L(r,"width","18"),L(r,"fill","currentColor"),L(n,"class",l="btn btn--chapters "+e[0])},m(t,s){v(t,n,s),$(n,r),$(r,o),c||(i=[S(n,"mouseout",e[2]),S(n,"mouseover",e[1])],c=!0)},p(t,[e]){1&e&&l!==(l="btn btn--chapters "+t[0])&&L(n,"class",l)},i:t,o:t,d(t){t&&g(n),c=!1,s(i)}}}function St(t,e,n){let{class:s}=e;return t.$$set=t=>{"class"in t&&n(0,s=t.class)},[s,()=>{document.querySelector(".header__chapters").classList.add("popup-wrapper--active")},()=>{document.querySelector(".header__chapters").classList.remove("popup-wrapper--active")}]}class Mt extends ct{constructor(t){super(),lt(this,t,St,kt,o,{class:0})}}function Lt(e){let n,s,r,o,l,c,i,a;return{c(){n=b("label"),s=b("input"),r=x(),o=y("svg"),l=y("path"),L(s,"type","file"),s.multiple=!0,L(s,"accept",".fb2"),L(s,"class","svelte-1caecej"),L(l,"d","M13 7H1m6-6v12"),L(l,"stroke","currentColor"),L(l,"stroke-width","2"),L(l,"stroke-linecap","round"),L(o,"width","14"),L(o,"viewBox","0 0 14 14"),L(n,"class",c="add-book btn btn--add "+e[0]+" svelte-1caecej")},m(t,c){v(t,n,c),$(n,s),$(n,r),$(n,o),$(o,l),i||(a=S(s,"input",e[1]),i=!0)},p(t,[e]){1&e&&c!==(c="add-book btn btn--add "+t[0]+" svelte-1caecej")&&L(n,"class",c)},i:t,o:t,d(t){t&&g(n),i=!1,a()}}}function qt(t,e,n){let{class:s}=e;return t.$$set=t=>{"class"in t&&n(0,s=t.class)},[s,t=>vt.addFiles(t.target.files)]}class Tt extends ct{constructor(t){super(),lt(this,t,qt,Lt,o,{class:0})}}function Nt(t){let e,n;return e=new Mt({props:{class:"header__btn"}}),{c(){nt(e.$$.fragment)},m(t,s){st(e,t,s),n=!0},i(t){n||(K(e.$$.fragment,t),n=!0)},o(t){Q(e.$$.fragment,t),n=!1},d(t){rt(e,t)}}}function Ct(t){let e,n;return e=new Tt({props:{class:"header__btn"}}),{c(){nt(e.$$.fragment)},m(t,s){st(e,t,s),n=!0},i(t){n||(K(e.$$.fragment,t),n=!0)},o(t){Q(e.$$.fragment,t),n=!1},d(t){rt(e,t)}}}function Et(t){let e,n,s,r,o,l,c;e=new bt({props:{class:"header__btn"}}),s=new xt({props:{class:"header__btn"}});let i="book"==t[1].active&&t[0].length&&Nt(),a="home"==t[1].active&&Ct();return{c(){nt(e.$$.fragment),n=x(),nt(s.$$.fragment),r=x(),i&&i.c(),o=x(),a&&a.c(),l=k()},m(t,u){st(e,t,u),v(t,n,u),st(s,t,u),v(t,r,u),i&&i.m(t,u),v(t,o,u),a&&a.m(t,u),v(t,l,u),c=!0},p(t,[e]){"book"==t[1].active&&t[0].length?i?3&e&&K(i,1):(i=Nt(),i.c(),K(i,1),i.m(o.parentNode,o)):i&&(X(),Q(i,1,1,(()=>{i=null})),G()),"home"==t[1].active?a?2&e&&K(a,1):(a=Ct(),a.c(),K(a,1),a.m(l.parentNode,l)):a&&(X(),Q(a,1,1,(()=>{a=null})),G())},i(t){c||(K(e.$$.fragment,t),K(s.$$.fragment,t),K(i),K(a),c=!0)},o(t){Q(e.$$.fragment,t),Q(s.$$.fragment,t),Q(i),Q(a),c=!1},d(t){rt(e,t),t&&g(n),rt(s,t),t&&g(r),i&&i.d(t),t&&g(o),a&&a.d(t),t&&g(l)}}}function Ft(t,e,n){let s,r;a(t,vt,(t=>n(3,s=t))),a(t,$t,(t=>n(1,r=t)));let o,l=[];return t.$$.update=()=>{12&t.$$.dirty&&(n(2,o=s.list[s.active]),o&&o.chapters&&n(0,l=o.chapters))},[l,r,o,s]}class Ht extends ct{constructor(t){super(),lt(this,t,Ft,Et,o,{})}}function zt(){const t=document.body,e=document.webkitIsFullScreen||document.mozFullScreen||!1;t.requestFullScreen=t.requestFullScreen||t.webkitRequestFullScreen||t.mozRequestFullScreen||function(){return!1},document.cancelFullScreen=document.cancelFullScreen||document.webkitCancelFullScreen||document.mozCancelFullScreen||function(){return!1},e?document.cancelFullScreen():t.requestFullScreen()}function jt(e){let n,s,r,o,l,c,i;return{c(){n=b("button"),s=y("svg"),r=y("path"),o=y("path"),L(r,"d","M19.38 2.86L3.12 19.12M19.38 2.86l-1.13 5.37m1.13-5.37l-5.37 1.13M3.12 19.12l1.13-5.37m-1.13 5.37L8.5 18"),L(r,"class","fullscreen--off"),L(o,"d","M5.24 21.5l1.42-5.65m0 0L1 17.26m5.66-1.41l9.19-9.2m0 0L17.26 1m-1.41 5.66l5.66-1.42"),L(o,"class","fullscreen--on"),L(s,"viewBox","0 0 23 23"),L(s,"width","20"),L(s,"stroke-linecap","round"),L(s,"stroke-linejoin","round"),L(s,"stroke","currentColor"),L(n,"class",l="btn btn--fullscreen "+e[0])},m(t,e){v(t,n,e),$(n,s),$(s,r),$(s,o),c||(i=S(n,"click",zt),c=!0)},p(t,[e]){1&e&&l!==(l="btn btn--fullscreen "+t[0])&&L(n,"class",l)},i:t,o:t,d(t){t&&g(n),c=!1,i()}}}function It(t,e,n){let{class:s}=e;return t.$$set=t=>{"class"in t&&n(0,s=t.class)},[s]}class Ot extends ct{constructor(t){super(),lt(this,t,It,jt,o,{class:0})}}function At(e){let n,s;return n=new Ot({props:{class:"header__btn"}}),{c(){nt(n.$$.fragment)},m(t,e){st(n,t,e),s=!0},p:t,i(t){s||(K(n.$$.fragment,t),s=!0)},o(t){Q(n.$$.fragment,t),s=!1},d(t){rt(n,t)}}}class Rt extends ct{constructor(t){super(),lt(this,t,null,At,o,{})}}function Pt(e){let n,r,o,l,c,i,a,u,d,p;return{c(){n=b("div"),r=b("input"),o=x(),l=b("div"),c=b("div"),i=x(),a=b("div"),L(r,"type","range"),L(r,"min",e[2]),L(r,"max",e[3]),L(r,"class","svelte-d8q7c5"),L(c,"class","range__track svelte-d8q7c5"),L(a,"class","range__thumb svelte-d8q7c5"),L(l,"class","range svelte-d8q7c5"),N(l,"--percent",e[4]+"%"),L(n,"class",u="wrapper "+e[1]+" svelte-d8q7c5")},m(t,s){v(t,n,s),$(n,r),T(r,e[0]),$(n,o),$(n,l),$(l,c),$(l,i),$(l,a),d||(p=[S(r,"change",e[8]),S(r,"input",e[8]),S(r,"change",e[5]),S(r,"input",e[6]),S(r,"pointerup",e[5])],d=!0)},p(t,[e]){4&e&&L(r,"min",t[2]),8&e&&L(r,"max",t[3]),1&e&&T(r,t[0]),16&e&&N(l,"--percent",t[4]+"%"),2&e&&u!==(u="wrapper "+t[1]+" svelte-d8q7c5")&&L(n,"class",u)},i:t,o:t,d(t){t&&g(n),d=!1,s(p)}}}function Bt(t,e,n){let{className:s}=e,{min:r=0}=e,{max:o=100}=e,{value:l}=e,{_value:c}=e,i=!c;i&&(c=l);const a=F();let u=0;return t.$$set=t=>{"className"in t&&n(1,s=t.className),"min"in t&&n(2,r=t.min),"max"in t&&n(3,o=t.max),"value"in t&&n(7,l=t.value),"_value"in t&&n(0,c=t._value)},t.$$.update=()=>{13&t.$$.dirty&&n(4,u=(c-r)/(o-r)*100)},[c,s,r,o,u,t=>{n(7,l=c),a("change",t)},t=>{i&&n(7,l=c),a("input",t)},l,function(){c=function(t){return""===t?null:+t}(this.value),n(0,c)}]}class Jt extends ct{constructor(t){super(),lt(this,t,Bt,Pt,o,{className:1,min:2,max:3,value:7,_value:0})}}function Wt(e){let n,s,r,o,l,c,i;return{c(){n=b("label"),s=b("input"),r=x(),o=b("div"),l=w(e[2]),L(s,"type","radio"),s.__value=e[1],s.value=s.__value,L(s,"class","radio__input svelte-1cmymy4"),e[5][0].push(s),L(o,"class","radio__label svelte-1cmymy4"),L(n,"class","radio svelte-1cmymy4"),L(n,"style",e[3])},m(t,a){v(t,n,a),$(n,s),s.checked=s.__value===e[0],$(n,r),$(n,o),$(o,l),c||(i=S(s,"change",e[4]),c=!0)},p(t,[e]){2&e&&(s.__value=t[1],s.value=s.__value),1&e&&(s.checked=s.__value===t[0]),4&e&&q(l,t[2]),8&e&&L(n,"style",t[3])},i:t,o:t,d(t){t&&g(n),e[5][0].splice(e[5][0].indexOf(s),1),c=!1,i()}}}function Zt(t,e,n){let{group:s}=e,{value:r}=e,{label:o}=e,{style:l}=e;return t.$$set=t=>{"group"in t&&n(0,s=t.group),"value"in t&&n(1,r=t.value),"label"in t&&n(2,o=t.label),"style"in t&&n(3,l=t.style)},[s,r,o,l,function(){s=this.__value,n(0,s)},[[]]]}class Dt extends ct{constructor(t){super(),lt(this,t,Zt,Wt,o,{group:0,value:1,label:2,style:3})}}function Vt(t){let e,n,s,r,o,l,c,i,a;const d=t[6].default,_=u(d,t,t[5],null);return{c(){e=b("div"),n=b("select"),_&&_.c(),r=x(),o=b("div"),l=w(t[4]),L(n,"class",s=m(t[1])+" svelte-g580vn"),void 0===t[0]&&R((()=>t[8].call(n))),L(o,"class","select svelte-g580vn"),N(o,"width",t[3]+"px"),L(e,"class","wrapper svelte-g580vn")},m(s,u){v(s,e,u),$(e,n),_&&_.m(n,null),t[7](n),C(n,t[0]),$(e,r),$(e,o),$(o,l),c=!0,i||(a=S(n,"change",t[8]),i=!0)},p(t,[e]){_&&_.p&&(!c||32&e)&&f(_,d,t,t[5],c?p(d,t[5],e,null):h(t[5]),null),(!c||2&e&&s!==(s=m(t[1])+" svelte-g580vn"))&&L(n,"class",s),1&e&&C(n,t[0]),(!c||16&e)&&q(l,t[4]),(!c||8&e)&&N(o,"width",t[3]+"px")},i(t){c||(K(_,t),c=!0)},o(t){Q(_,t),c=!1},d(n){n&&g(e),_&&_.d(n),t[7](null),i=!1,a()}}}function Xt(t,e,n){let s,r,o,{$$slots:l={},$$scope:c}=e,{className:i}=e,{value:a}=e;return t.$$set=t=>{"className"in t&&n(1,i=t.className),"value"in t&&n(0,a=t.value),"$$scope"in t&&n(5,c=t.$$scope)},t.$$.update=()=>{if(5&t.$$.dirty&&r){n(3,s=r?.offsetWidth);const t=r.querySelector(`[value="${a}"]`);n(4,o=t?t.innerText:a)}},[a,i,r,s,o,c,l,function(t){z[t?"unshift":"push"]((()=>{r=t,n(2,r)}))},function(){a=function(t){const e=t.querySelector(":checked")||t.options[0];return e&&e.__value}(this),n(0,a)}]}class Gt extends ct{constructor(t){super(),lt(this,t,Xt,Vt,o,{className:1,value:0})}}function Kt(t){let e,n,s,r,o,l,c,i,a,u,d,p=t[0].title+"",f=t[0].author+"",h=Math.floor(1e3*t[0].progress)/10+"",m=t[0].chapter&&Qt(t);return{c(){e=b("div"),n=b("p"),s=w(p),r=x(),o=b("p"),l=w(f),c=x(),m&&m.c(),i=x(),a=b("p"),u=w(h),d=w("%"),L(n,"class","book__title svelte-1aisi1b"),L(o,"class","book__author svelte-1aisi1b"),L(a,"class","book__progress svelte-1aisi1b"),L(e,"class","book svelte-1aisi1b")},m(t,p){v(t,e,p),$(e,n),$(n,s),$(e,r),$(e,o),$(o,l),$(e,c),m&&m.m(e,null),$(e,i),$(e,a),$(a,u),$(a,d)},p(t,n){1&n&&p!==(p=t[0].title+"")&&q(s,p),1&n&&f!==(f=t[0].author+"")&&q(l,f),t[0].chapter?m?m.p(t,n):(m=Qt(t),m.c(),m.m(e,i)):m&&(m.d(1),m=null),1&n&&h!==(h=Math.floor(1e3*t[0].progress)/10+"")&&q(u,h)},d(t){t&&g(e),m&&m.d()}}}function Qt(t){let e,n=t[0].chapter.innerHTML+"";return{c(){e=b("p"),L(e,"class","book__chapter svelte-1aisi1b")},m(t,s){v(t,e,s),e.innerHTML=n},p(t,s){1&s&&n!==(n=t[0].chapter.innerHTML+"")&&(e.innerHTML=n)},d(t){t&&g(e)}}}function Ut(e){let n,s,r;document.title=n=e[2];let o="book"==e[1].active&&e[0]&&e[0].inited&&Kt(e);return{c(){s=x(),o&&o.c(),r=k()},m(t,e){v(t,s,e),o&&o.m(t,e),v(t,r,e)},p(t,[e]){4&e&&n!==(n=t[2])&&(document.title=n),"book"==t[1].active&&t[0]&&t[0].inited?o?o.p(t,e):(o=Kt(t),o.c(),o.m(r.parentNode,r)):o&&(o.d(1),o=null)},i:t,o:t,d(t){t&&g(s),o&&o.d(t),t&&g(r)}}}function Yt(t,e,n){let s,r,o,l;return a(t,$t,(t=>n(1,s=t))),a(t,vt,(t=>n(3,r=t))),t.$$.update=()=>{11&t.$$.dirty&&(n(0,o=r.list[r.active]),"book"==s.active?n(2,l=`${o.title} - Reader`):n(2,l="Reader"))},[o,s,l,r]}class te extends ct{constructor(t){super(),lt(this,t,Yt,Ut,o,{})}}function ee(t,e,n){const s=t.slice();return s[18]=e[n],s}function ne(t){let e,n,s,r,o,l,c,i,a,u,d,p,f;return{c(){e=b("option"),e.textContent="Сепия",n=x(),s=b("option"),s.textContent="Сепия контарст",r=x(),o=b("option"),o.textContent="День",l=x(),c=b("option"),c.textContent="Ночь",i=x(),a=b("option"),a.textContent="Ночь контарст",u=x(),d=b("option"),d.textContent="Сумерки",p=x(),f=b("option"),f.textContent="Консоль",e.__value="sepia",e.value=e.__value,s.__value="sepia-contrast",s.value=s.__value,o.__value="day",o.value=o.__value,c.__value="night",c.value=c.__value,a.__value="night-contrast",a.value=a.__value,d.__value="dusk",d.value=d.__value,f.__value="console",f.value=f.__value},m(t,h){v(t,e,h),v(t,n,h),v(t,s,h),v(t,r,h),v(t,o,h),v(t,l,h),v(t,c,h),v(t,i,h),v(t,a,h),v(t,u,h),v(t,d,h),v(t,p,h),v(t,f,h)},d(t){t&&g(e),t&&g(n),t&&g(s),t&&g(r),t&&g(o),t&&g(l),t&&g(c),t&&g(i),t&&g(a),t&&g(u),t&&g(d),t&&g(p),t&&g(f)}}}function se(t){let e,n,s,r,o,l,c;return{c(){e=b("option"),e.textContent="Roboto Slab",n=x(),s=b("option"),s.textContent="Jura",r=x(),o=b("option"),o.textContent="Playfair Display",l=x(),c=b("option"),c.textContent="Raleway",e.__value="RobotoSlab",e.value=e.__value,s.__value="Jura",s.value=s.__value,o.__value="PlayfairDisplay",o.value=o.__value,c.__value="Raleway",c.value=c.__value},m(t,i){v(t,e,i),v(t,n,i),v(t,s,i),v(t,r,i),v(t,o,i),v(t,l,i),v(t,c,i)},d(t){t&&g(e),t&&g(n),t&&g(s),t&&g(r),t&&g(o),t&&g(l),t&&g(c)}}}function re(t){let e,n,s;function r(e){t[16](e)}let o={value:t[18],label:"А",style:"font-weight: "+t[18]+";"};return void 0!==t[5]&&(o.group=t[5]),e=new Dt({props:o}),z.push((()=>et(e,"group",r))),{c(){nt(e.$$.fragment)},m(t,n){st(e,t,n),s=!0},p(t,s){const r={};!n&&32&s&&(n=!0,r.group=t[5],P((()=>n=!1))),e.$set(r)},i(t){s||(K(e.$$.fragment,t),s=!0)},o(t){Q(e.$$.fragment,t),s=!1},d(t){rt(e,t)}}}function oe(t){let e,n,s,r,o,l,c,i,a,u,d,p,f,h,m,y,k,S,M,T,C,E,F,H,j,I,O,A,R,B,J,W,Z,D,V,U,Y,tt,ot,lt,ct,it,at,ut,dt,pt,ft,ht,mt=2*t[3]+"";function $t(e){t[10](e)}function vt(e){t[11](e)}n=new te({});let gt={className:"width__input",min:"100",max:window.innerWidth-20};function _t(e){t[12](e)}function bt(e){t[13](e)}void 0!==t[2]&&(gt.value=t[2]),void 0!==t[1]&&(gt._value=t[1]),p=new Jt({props:gt}),z.push((()=>et(p,"value",$t))),z.push((()=>et(p,"_value",vt))),p.$on("change",t[8]),p.$on("input",t[9]);let yt={className:"width__input",min:"2",max:Math.floor(window.innerHeight/(2*t[7]*1.25))};function wt(e){t[14](e)}void 0!==t[4]&&(yt.value=t[4]),void 0!==t[3]&&(yt._value=t[3]),y=new Jt({props:yt}),z.push((()=>et(y,"value",_t))),z.push((()=>et(y,"_value",bt))),y.$on("change",t[8]),y.$on("input",t[9]);let xt={className:"scheme__input",$$slots:{default:[ne]},$$scope:{ctx:t}};function kt(e){t[15](e)}void 0!==t[0]&&(xt.value=t[0]),F=new Gt({props:xt}),z.push((()=>et(F,"value",wt)));let St={className:"font__input",$$slots:{default:[se]},$$scope:{ctx:t}};void 0!==t[6]&&(St.value=t[6]),R=new Gt({props:St}),z.push((()=>et(R,"value",kt)));let Mt=[300,400,600,700],Lt=[];for(let e=0;e<4;e+=1)Lt[e]=re(ee(t,Mt,e));const qt=t=>Q(Lt[t],1,1,(()=>{Lt[t]=null}));function Tt(e){t[17](e)}let Nt={className:"font-size__input",min:"12",max:"30"};return void 0!==t[7]&&(Nt.value=t[7]),pt=new Jt({props:Nt}),z.push((()=>et(pt,"value",Tt))),{c(){e=b("div"),nt(n.$$.fragment),s=x(),r=b("div"),o=b("h3"),l=w("Размер текста "),c=b("span"),i=w(t[1]),a=w("x"),u=w(mt),d=x(),nt(p.$$.fragment),m=x(),nt(y.$$.fragment),M=x(),T=b("div"),C=b("h3"),C.innerHTML="Цветовая<br/>схема",E=x(),nt(F.$$.fragment),j=x(),I=b("div"),O=b("h3"),O.textContent="Шрифт",A=x(),nt(R.$$.fragment),J=x(),W=b("div"),Z=b("h3"),D=w("Жирность "),V=b("span"),U=w(t[5]),Y=x(),tt=b("fieldset");for(let t=0;t<4;t+=1)Lt[t].c();ot=x(),lt=b("div"),ct=b("h3"),it=w("Кегль "),at=b("span"),ut=w(t[7]),dt=x(),nt(pt.$$.fragment),L(c,"class","svelte-nrlmcn"),L(o,"class","setting__title svelte-nrlmcn"),L(r,"class","settings__field svelte-nrlmcn"),L(C,"class","setting__title svelte-nrlmcn"),L(T,"class","settings__field settings__field--select svelte-nrlmcn"),L(O,"class","setting__title svelte-nrlmcn"),L(I,"class","settings__field settings__field--select svelte-nrlmcn"),L(V,"class","svelte-nrlmcn"),L(Z,"class","setting__title svelte-nrlmcn"),N(Z,"font-weight",t[5]),L(tt,"class","settings__fieldset svelte-nrlmcn"),N(tt,"font-family","var(--font-family)"),L(W,"class","settings__field svelte-nrlmcn"),L(at,"class","svelte-nrlmcn"),L(ct,"class","setting__title svelte-nrlmcn"),L(lt,"class","settings__field svelte-nrlmcn"),L(e,"class","settings popup")},m(t,f){v(t,e,f),st(n,e,null),$(e,s),$(e,r),$(r,o),$(o,l),$(o,c),$(c,i),$(c,a),$(c,u),$(r,d),st(p,r,null),$(r,m),st(y,r,null),$(e,M),$(e,T),$(T,C),$(T,E),st(F,T,null),$(e,j),$(e,I),$(I,O),$(I,A),st(R,I,null),$(e,J),$(e,W),$(W,Z),$(Z,D),$(Z,V),$(V,U),$(W,Y),$(W,tt);for(let t=0;t<4;t+=1)Lt[t].m(tt,null);$(e,ot),$(e,lt),$(lt,ct),$(ct,it),$(ct,at),$(at,ut),$(lt,dt),st(pt,lt,null),ht=!0},p(t,[e]){(!ht||2&e)&&q(i,t[1]),(!ht||8&e)&&mt!==(mt=2*t[3]+"")&&q(u,mt);const n={};!f&&4&e&&(f=!0,n.value=t[2],P((()=>f=!1))),!h&&2&e&&(h=!0,n._value=t[1],P((()=>h=!1))),p.$set(n);const s={};128&e&&(s.max=Math.floor(window.innerHeight/(2*t[7]*1.25))),!k&&16&e&&(k=!0,s.value=t[4],P((()=>k=!1))),!S&&8&e&&(S=!0,s._value=t[3],P((()=>S=!1))),y.$set(s);const r={};2097152&e&&(r.$$scope={dirty:e,ctx:t}),!H&&1&e&&(H=!0,r.value=t[0],P((()=>H=!1))),F.$set(r);const o={};if(2097152&e&&(o.$$scope={dirty:e,ctx:t}),!B&&64&e&&(B=!0,o.value=t[6],P((()=>B=!1))),R.$set(o),(!ht||32&e)&&q(U,t[5]),(!ht||32&e)&&N(Z,"font-weight",t[5]),32&e){let n;for(Mt=[300,400,600,700],n=0;n<4;n+=1){const s=ee(t,Mt,n);Lt[n]?(Lt[n].p(s,e),K(Lt[n],1)):(Lt[n]=re(s),Lt[n].c(),K(Lt[n],1),Lt[n].m(tt,null))}for(X(),n=4;n<4;n+=1)qt(n);G()}(!ht||128&e)&&q(ut,t[7]);const l={};!ft&&128&e&&(ft=!0,l.value=t[7],P((()=>ft=!1))),pt.$set(l)},i(t){if(!ht){K(n.$$.fragment,t),K(p.$$.fragment,t),K(y.$$.fragment,t),K(F.$$.fragment,t),K(R.$$.fragment,t);for(let t=0;t<4;t+=1)K(Lt[t]);K(pt.$$.fragment,t),ht=!0}},o(t){Q(n.$$.fragment,t),Q(p.$$.fragment,t),Q(y.$$.fragment,t),Q(F.$$.fragment,t),Q(R.$$.fragment,t),Lt=Lt.filter(Boolean);for(let t=0;t<4;t+=1)Q(Lt[t]);Q(pt.$$.fragment,t),ht=!1},d(t){t&&g(e),rt(n),rt(p),rt(y),rt(F),rt(R),_(Lt,t),rt(pt)}}}function le(t,e,n){let s=mt.get("scheme"),r=mt.get("book-width-tmp"),o=mt.get("book-width"),l=mt.get("book-height-tmp"),c=mt.get("book-height"),i=mt.get("font-weight"),a=mt.get("font-family"),u=mt.get("font-size");return t.$$.update=()=>{1&t.$$.dirty&&mt.add("scheme",s),4&t.$$.dirty&&mt.add("book-width",o),2&t.$$.dirty&&mt.add("book-width-tmp",r),8&t.$$.dirty&&mt.add("book-height-tmp",l),16&t.$$.dirty&&mt.add("book-height",c),32&t.$$.dirty&&mt.add("font-weight",i),64&t.$$.dirty&&mt.add("font-family",a),128&t.$$.dirty&&mt.add("font-size",u)},[s,r,o,l,c,i,a,u,t=>{t.detail,document.body.classList.remove("size-changing")},t=>{t.detail,document.body.classList.add("size-changing")},function(t){o=t,n(2,o)},function(t){r=t,n(1,r)},function(t){c=t,n(4,c)},function(t){l=t,n(3,l)},function(t){s=t,n(0,s)},function(t){a=t,n(6,a)},function(t){i=t,n(5,i)},function(t){u=t,n(7,u)}]}class ce extends ct{constructor(t){super(),lt(this,t,le,oe,o,{})}}function ie(t,e,n){const s=t.slice();return s[3]=e[n],s}function ae(t){let e,n,s,r,o,l=t[0].title+"",c=t[0].chapters,i=[];for(let e=0;e<c.length;e+=1)i[e]=ue(ie(t,c,e));return{c(){e=b("div"),n=b("h2"),s=w(l),r=x(),o=b("ul");for(let t=0;t<i.length;t+=1)i[t].c();L(n,"class","svelte-xednov"),L(o,"class","chapters__list svelte-xednov"),L(e,"class","chapters popup")},m(t,l){v(t,e,l),$(e,n),$(n,s),$(e,r),$(e,o);for(let t=0;t<i.length;t+=1)i[t].m(o,null)},p(t,e){if(1&e&&l!==(l=t[0].title+"")&&q(s,l),3&e){let n;for(c=t[0].chapters,n=0;n<c.length;n+=1){const s=ie(t,c,n);i[n]?i[n].p(s,e):(i[n]=ue(s),i[n].c(),i[n].m(o,null))}for(;n<i.length;n+=1)i[n].d(1);i.length=c.length}},d(t){t&&g(e),_(i,t)}}}function ue(t){let e,n,s,o,l,c,i=t[3].innerText+"";return{c(){e=b("li"),n=b("button"),s=w(i),o=x(),L(n,"class","chapters__btn svelte-xednov"),L(e,"class","chapters__item")},m(i,a){v(i,e,a),$(e,n),$(n,s),$(e,o),l||(c=S(n,"click",(function(){r(t[1].bind(t[3]))&&t[1].bind(t[3]).apply(this,arguments)})),l=!0)},p(e,n){t=e,1&n&&i!==(i=t[3].innerText+"")&&q(s,i)},d(t){t&&g(e),l=!1,c()}}}function de(e){let n,s=e[0]&&e[0].inited&&e[0].chapters.length&&ae(e);return{c(){s&&s.c(),n=k()},m(t,e){s&&s.m(t,e),v(t,n,e)},p(t,[e]){t[0]&&t[0].inited&&t[0].chapters.length?s?s.p(t,e):(s=ae(t),s.c(),s.m(n.parentNode,n)):s&&(s.d(1),s=null)},i:t,o:t,d(t){s&&s.d(t),t&&g(n)}}}function pe(t,e,n){let s,r;return a(t,vt,(t=>n(2,s=t))),t.$$.update=()=>{4&t.$$.dirty&&n(0,r=s.list[s.active])},[r,function(){r.showChapter(this),n(0,r.chapter=this,r)},s]}class fe extends ct{constructor(t){super(),lt(this,t,pe,de,o,{})}}function he(e){let n,s,r,o,l,c,i,a,u,d,p,f,h;return r=new Ht({}),c=new Rt({}),u=new ce({}),f=new fe({}),{c(){n=b("header"),s=b("div"),nt(r.$$.fragment),o=x(),l=b("div"),nt(c.$$.fragment),i=x(),a=b("div"),nt(u.$$.fragment),d=x(),p=b("div"),nt(f.$$.fragment),L(s,"class","header__controls svelte-1q5vita"),L(l,"class","header__controls svelte-1q5vita"),L(a,"class","header__settings popup-wrapper"),L(p,"class","header__chapters popup-wrapper"),L(n,"class","header svelte-1q5vita")},m(t,e){v(t,n,e),$(n,s),st(r,s,null),$(n,o),$(n,l),st(c,l,null),$(n,i),$(n,a),st(u,a,null),$(n,d),$(n,p),st(f,p,null),h=!0},p:t,i(t){h||(K(r.$$.fragment,t),K(c.$$.fragment,t),K(u.$$.fragment,t),K(f.$$.fragment,t),h=!0)},o(t){Q(r.$$.fragment,t),Q(c.$$.fragment,t),Q(u.$$.fragment,t),Q(f.$$.fragment,t),h=!1},d(t){t&&g(n),rt(r),rt(c),rt(u),rt(f)}}}class me extends ct{constructor(t){super(),lt(this,t,null,he,o,{})}}function $e(t){let e,n,s;const r=t[3].default,o=u(r,t,t[2],null);return{c(){e=b("div"),o&&o.c(),L(e,"class",n="screen screen--"+t[0]+" "+(t[0]==t[1].active?"screen--active":"")+" svelte-1pwbfoa")},m(t,n){v(t,e,n),o&&o.m(e,null),s=!0},p(t,[l]){o&&o.p&&(!s||4&l)&&f(o,r,t,t[2],s?p(r,t[2],l,null):h(t[2]),null),(!s||3&l&&n!==(n="screen screen--"+t[0]+" "+(t[0]==t[1].active?"screen--active":"")+" svelte-1pwbfoa"))&&L(e,"class",n)},i(t){s||(K(o,t),s=!0)},o(t){Q(o,t),s=!1},d(t){t&&g(e),o&&o.d(t)}}}function ve(t,e,n){let s;a(t,$t,(t=>n(1,s=t)));let{$$slots:r={},$$scope:o}=e,{name:l}=e;return t.$$set=t=>{"name"in t&&n(0,l=t.name),"$$scope"in t&&n(2,o=t.$$scope)},[l,s,o,r]}class ge extends ct{constructor(t){super(),lt(this,t,ve,$e,o,{name:0})}}const _e={v:"p",poem:"div",stanza:"div",emphasis:"em",description:"div","empty-line":"br",epigraph:"div","text-author":"p",cite:"div"};class be extends class{constructor(t){this.id=t,this.chapters=[],this.progress=this._getFromLocalStorage().progress||0}open(){setTimeout((()=>{this.element.parentNode.scrollTop=this.progress*this.element.offsetHeight}),1)}_getFromLocalStorage(){const t=localStorage.getItem("books")??"{}",e=JSON.parse(t);return e[this.id]||(e[this.id]={}),e[this.id]}_saveToLocalStorage(t){const e=localStorage.getItem("books")??"{}",n=JSON.parse(e);n[this.id]=t;const s=JSON.stringify(n);localStorage.setItem("books",s)}scrollToChapter(t){}_curentChapter(t){let e;for(const n in this.chapters){if(this.chapters[n].offsetTop>t){e=0==n?this.chapters[0]:this.chapters[n-1];break}}this.chapter=e||this.chapters[this.chapters.length-1]}setProgress(t,e){this.progress=t/e,this.chapters.length&&this._curentChapter(t)}set progress(t){this._progress=t;const e=this._getFromLocalStorage();e.progress=t,this._saveToLocalStorage(e)}get progress(){return this._progress}}{constructor(t,e){super(e),this.data=t,this.element=this.bookFromXML(t),this.author=this._getAuthor(),this.cover=this._getCover(),this.title=this._getTitle()}bookFromXML(t){const e=document.createElement("div");return e.innerHTML=t,e.innerHTML=e.querySelector("fictionbook").innerHTML,e.className="book__container",e.dataset.book=this.id,this._headings(e),this._tags(e),e}_getAuthor(){const t=this.element.querySelector("author");return Array.from(t.children).map((t=>t.innerText)).join(" ")}_getTitle(){return this.element.querySelector("book-title").innerText}_getCover(){const t=this.element.querySelector('binary[id="cover.jpg"]');if(!t)return null;const e=`data:${t.getAttribute("content-type")};base64,${t.innerHTML}`;return t.remove(),e}_headings(t){t.querySelectorAll("title").forEach((t=>{const e="h"+parseInt(["section"].indexOf(t.parentElement.tagName.toLocaleLowerCase())+3),n=document.createElement(e);n.innerHTML=t.innerText.trim(),n.innerHTML="h3"==e?n.innerText.trim():n.innerText,t.replaceWith(n)})),this.chapters=t.querySelectorAll("h3")}_tags(t){Object.entries(_e).forEach((([e,n])=>{const s=n.split(".");t.querySelectorAll(e).forEach((t=>{const n=document.createElement(s[0]);n.className=e,n.innerHTML=t.innerHTML,t.replaceWith(n)}))}))}}function ye(e){let n,s,r,o,l,c,i,a,u;return{c(){n=b("article"),s=b("div"),r=x(),o=b("div"),l=x(),c=b("div"),L(s,"class","book__page svelte-1uxbrw8"),L(o,"class","book__border book__border--top svelte-1uxbrw8"),L(c,"class","book__border book__border--bottom svelte-1uxbrw8"),L(n,"class",i="book "+(e[2].active==e[0]?"book--active":"")+" svelte-1uxbrw8"),N(n,"--line-height",we)},m(t,i){v(t,n,i),$(n,s),$(n,r),$(n,o),$(n,l),$(n,c),e[6](n),a||(u=S(n,"scroll",e[3]),a=!0)},p(t,[e]){5&e&&i!==(i="book "+(t[2].active==t[0]?"book--active":"")+" svelte-1uxbrw8")&&L(n,"class",i)},i:t,o:t,d(t){t&&g(n),e[6](null),a=!1,u()}}}let we=1.25;function xe(t,e,n){let s,r;a(t,mt,(t=>n(7,s=t))),a(t,vt,(t=>n(2,r=t)));let o,l,c,{id:i}=e;const u=t=>{const e=window.innerHeight-2*s["book-height"]*s["font-size"]*we;n(1,c.scrollTop=t.offsetTop-e/2,c)};return t.$$set=t=>{"id"in t&&n(0,i=t.id)},t.$$.update=()=>{55&t.$$.dirty&&(n(5,l=r.list[i]),l&&c&&!l.inited&&(n(4,o=new be(l.data,i)),n(4,o.showChapter=u,o),n(4,o.inited=!0,o),vt.add(i,o),c.appendChild(o.element),o.open()))},[i,c,r,function(){o.setProgress(c.scrollTop,c.scrollHeight),vt.add(i,o)},o,l,function(t){z[t?"unshift":"push"]((()=>{c=t,n(1,c)}))}]}class ke extends ct{constructor(t){super(),lt(this,t,xe,ye,o,{id:0})}}function Se(t,e,n){const s=t.slice();return s[2]=e[n],s}function Me(t,e){let n,s,r;return s=new ke({props:{id:e[2]}}),{key:t,first:null,c(){n=k(),nt(s.$$.fragment),this.first=n},m(t,e){v(t,n,e),st(s,t,e),r=!0},p(t,n){e=t;const r={};1&n&&(r.id=e[2]),s.$set(r)},i(t){r||(K(s.$$.fragment,t),r=!0)},o(t){Q(s.$$.fragment,t),r=!1},d(t){t&&g(n),rt(s,t)}}}function Le(t){let e,n,s=[],r=new Map,o=t[0];const l=t=>t[2];for(let e=0;e<o.length;e+=1){let n=Se(t,o,e),c=l(n);r.set(c,s[e]=Me(c,n))}return{c(){for(let t=0;t<s.length;t+=1)s[t].c();e=k()},m(t,r){for(let e=0;e<s.length;e+=1)s[e].m(t,r);v(t,e,r),n=!0},p(t,n){1&n&&(o=t[0],X(),s=tt(s,n,l,1,t,o,r,e.parentNode,Y,Me,e,Se),G())},i(t){if(!n){for(let t=0;t<o.length;t+=1)K(s[t]);n=!0}},o(t){for(let t=0;t<s.length;t+=1)Q(s[t]);n=!1},d(t){for(let e=0;e<s.length;e+=1)s[e].d(t);t&&g(e)}}}function qe(t){let e,n;return e=new ge({props:{name:"book",$$slots:{default:[Le]},$$scope:{ctx:t}}}),{c(){nt(e.$$.fragment)},m(t,s){st(e,t,s),n=!0},p(t,[n]){const s={};33&n&&(s.$$scope={dirty:n,ctx:t}),e.$set(s)},i(t){n||(K(e.$$.fragment,t),n=!0)},o(t){Q(e.$$.fragment,t),n=!1},d(t){rt(e,t)}}}function Te(t,e,n){let s;a(t,vt,(t=>n(1,s=t)));let r=[];return t.$$.update=()=>{2&t.$$.dirty&&s.listId&&n(0,r=s.listId)},[r,s]}class Ne extends ct{constructor(t){super(),lt(this,t,Te,qe,o,{})}}function Ce(t){let e,n,s,r,o,l,c,i,a,u,d,p,f,h,m,_,y=Math.floor(10*t[4])/10+"",k=t[5]&&Ee(t);return{c(){e=b("article"),n=b("div"),s=b("h3"),r=w(t[2]),o=x(),l=b("p"),c=w(t[3]),i=x(),a=b("div"),u=w(y),d=w("%\r\n\t\t\t\t"),p=b("div"),f=x(),k&&k.c(),L(s,"class","book-preview__title svelte-1fy2nqy"),L(l,"class","book-preview__author svelte-1fy2nqy"),L(p,"class","progress__bar svelte-1fy2nqy"),L(a,"class","book-preview__progress svelte-1fy2nqy"),N(a,"--progress",t[4]+"%"),L(n,"class","book-preview__description svelte-1fy2nqy"),L(e,"class",h="book-preview "+(t[5]&&"book-preview--cover")+" svelte-1fy2nqy"),L(e,"data-book",t[0])},m(h,g){v(h,e,g),$(e,n),$(n,s),$(s,r),$(n,o),$(n,l),$(l,c),$(n,i),$(n,a),$(a,u),$(a,d),$(a,p),$(e,f),k&&k.m(e,null),m||(_=S(e,"click",t[6]),m=!0)},p(t,n){4&n&&q(r,t[2]),8&n&&q(c,t[3]),16&n&&y!==(y=Math.floor(10*t[4])/10+"")&&q(u,y),16&n&&N(a,"--progress",t[4]+"%"),t[5]?k?k.p(t,n):(k=Ee(t),k.c(),k.m(e,null)):k&&(k.d(1),k=null),32&n&&h!==(h="book-preview "+(t[5]&&"book-preview--cover")+" svelte-1fy2nqy")&&L(e,"class",h),1&n&&L(e,"data-book",t[0])},d(t){t&&g(e),k&&k.d(),m=!1,_()}}}function Ee(t){let e,n;return{c(){e=b("img"),L(e,"class","book-preview__cover svelte-1fy2nqy"),i(e.src,n=t[5])||L(e,"src",n),L(e,"alt",t[2])},m(t,n){v(t,e,n)},p(t,s){32&s&&!i(e.src,n=t[5])&&L(e,"src",n),4&s&&L(e,"alt",t[2])},d(t){t&&g(e)}}}function Fe(e){let n,s=e[1]&&e[1].inited&&Ce(e);return{c(){s&&s.c(),n=k()},m(t,e){s&&s.m(t,e),v(t,n,e)},p(t,[e]){t[1]&&t[1].inited?s?s.p(t,e):(s=Ce(t),s.c(),s.m(n.parentNode,n)):s&&(s.d(1),s=null)},i:t,o:t,d(t){s&&s.d(t),t&&g(n)}}}function He(t,e,n){let s;a(t,vt,(t=>n(7,s=t)));let r,o,l,c,i,{id:u}=e;return t.$$set=t=>{"id"in t&&n(0,u=t.id)},t.$$.update=()=>{131&t.$$.dirty&&(n(1,r=s.list[u]),r&&r.inited&&(n(2,o=r.title),n(3,l=r.author),n(4,c=100*r.progress),n(5,i=r.cover)))},[u,r,o,l,c,i,t=>{$t.active="book",vt.active=u,r.open()},s]}class ze extends ct{constructor(t){super(),lt(this,t,He,Fe,o,{id:0})}}function je(t,e,n){const s=t.slice();return s[1]=e[n],s}function Ie(t,e){let n,s,r;return s=new ze({props:{id:e[1]}}),{key:t,first:null,c(){n=b("li"),nt(s.$$.fragment),L(n,"class","book-list__item svelte-nzpknj"),this.first=n},m(t,e){v(t,n,e),st(s,n,null),r=!0},p(t,n){e=t;const r={};1&n&&(r.id=e[1]),s.$set(r)},i(t){r||(K(s.$$.fragment,t),r=!0)},o(t){Q(s.$$.fragment,t),r=!1},d(t){t&&g(n),rt(s)}}}function Oe(t){let e,n,s=[],r=new Map,o=t[0];const l=t=>t[1];for(let e=0;e<o.length;e+=1){let n=je(t,o,e),c=l(n);r.set(c,s[e]=Ie(c,n))}return{c(){e=b("ul");for(let t=0;t<s.length;t+=1)s[t].c();L(e,"class","book-list svelte-nzpknj")},m(t,r){v(t,e,r);for(let t=0;t<s.length;t+=1)s[t].m(e,null);n=!0},p(t,[n]){1&n&&(o=t[0],X(),s=tt(s,n,l,1,t,o,r,e,Y,Ie,null,je),G())},i(t){if(!n){for(let t=0;t<o.length;t+=1)K(s[t]);n=!0}},o(t){for(let t=0;t<s.length;t+=1)Q(s[t]);n=!1},d(t){t&&g(e);for(let t=0;t<s.length;t+=1)s[t].d()}}}function Ae(t,e,n){let{list:s}=e;return t.$$set=t=>{"list"in t&&n(0,s=t.list)},[s]}class Re extends ct{constructor(t){super(),lt(this,t,Ae,Oe,o,{list:0})}}function Pe(e){let n,s,r,o,l,c,i;return{c(){n=b("div"),s=b("label"),r=b("h1"),r.textContent="Выберите файлы",o=x(),l=b("input"),L(r,"class","drag__title svelte-19e4qdm"),L(l,"type","file"),L(l,"class","drag__input svelte-19e4qdm"),L(l,"accept",".fb2"),l.multiple=!0,L(s,"class","drag svelte-19e4qdm"),L(n,"class","wrapper svelte-19e4qdm")},m(t,a){v(t,n,a),$(n,s),$(s,r),$(s,o),$(s,l),c||(i=S(l,"input",e[0]),c=!0)},p:t,i:t,o:t,d(t){t&&g(n),c=!1,i()}}}function Be(t){return[t=>vt.addFiles(t.target.files)]}class Je extends ct{constructor(t){super(),lt(this,t,Be,Pe,o,{})}}function We(e){let n;return{c(){n=b("div"),n.innerHTML='<div class="dropper__area svelte-ci4cx1"><h1>Drop</h1></div>',L(n,"class","dropper svelte-ci4cx1")},m(t,e){v(t,n,e)},p:t,i:t,o:t,d(t){t&&g(n)}}}class Ze extends ct{constructor(t){super(),lt(this,t,null,We,o,{})}}const{document:De}=U;function Ve(e){let n,s;return n=new Je({}),{c(){nt(n.$$.fragment)},m(t,e){st(n,t,e),s=!0},p:t,i(t){s||(K(n.$$.fragment,t),s=!0)},o(t){Q(n.$$.fragment,t),s=!1},d(t){rt(n,t)}}}function Xe(t){let e,n,s,r;return e=new Re({props:{list:t[0].listId||[]}}),s=new Ze({}),{c(){nt(e.$$.fragment),n=x(),nt(s.$$.fragment)},m(t,o){st(e,t,o),v(t,n,o),st(s,t,o),r=!0},p(t,n){const s={};1&n&&(s.list=t[0].listId||[]),e.$set(s)},i(t){r||(K(e.$$.fragment,t),K(s.$$.fragment,t),r=!0)},o(t){Q(e.$$.fragment,t),Q(s.$$.fragment,t),r=!1},d(t){rt(e,t),t&&g(n),rt(s,t)}}}function Ge(t){let e,n,s,r;const o=[Xe,Ve],l=[];function c(t,e){return t[0].listId?0:1}return e=c(t),n=l[e]=o[e](t),{c(){n.c(),s=k()},m(t,n){l[e].m(t,n),v(t,s,n),r=!0},p(t,r){let i=e;e=c(t),e===i?l[e].p(t,r):(X(),Q(l[i],1,1,(()=>{l[i]=null})),G(),n=l[e],n?n.p(t,r):(n=l[e]=o[e](t),n.c()),K(n,1),n.m(s.parentNode,s))},i(t){r||(K(n),r=!0)},o(t){Q(n),r=!1},d(t){l[e].d(t),t&&g(s)}}}function Ke(t){let e,n,r,o,l;return n=new ge({props:{name:"home",$$slots:{default:[Ge]},$$scope:{ctx:t}}}),{c(){e=x(),nt(n.$$.fragment)},m(s,c){v(s,e,c),st(n,s,c),r=!0,o||(l=[S(De.body,"dragover",M(Qe)),S(De.body,"dragleave",M(Ue)),S(De.body,"drop",M(t[1]))],o=!0)},p(t,[e]){const s={};5&e&&(s.$$scope={dirty:e,ctx:t}),n.$set(s)},i(t){r||(K(n.$$.fragment,t),r=!0)},o(t){Q(n.$$.fragment,t),r=!1},d(t){t&&g(e),rt(n,t),o=!1,s(l)}}}function Qe(){document.body.classList.add("drag--active")}function Ue(){document.body.classList.remove("drag--active")}function Ye(t,e,n){let s;return a(t,vt,(t=>n(0,s=t))),[s,function(t){document.body.classList.remove("drag--active"),vt.addFiles(t.dataTransfer.files)}]}class tn extends ct{constructor(t){super(),lt(this,t,Ye,Ke,o,{})}}function en(t){let e,n,s,r,o,l,c,i;return n=new me({}),r=new tn({}),l=new Ne({}),{c(){e=b("main"),nt(n.$$.fragment),s=x(),nt(r.$$.fragment),o=x(),nt(l.$$.fragment),L(e,"class",c="theme--"+t[0].scheme)},m(t,c){v(t,e,c),st(n,e,null),$(e,s),st(r,e,null),$(e,o),st(l,e,null),i=!0},p(t,[n]){(!i||1&n&&c!==(c="theme--"+t[0].scheme))&&L(e,"class",c)},i(t){i||(K(n.$$.fragment,t),K(r.$$.fragment,t),K(l.$$.fragment,t),i=!0)},o(t){Q(n.$$.fragment,t),Q(r.$$.fragment,t),Q(l.$$.fragment,t),i=!1},d(t){t&&g(e),rt(n),rt(r),rt(l)}}}function nn(t,e,n){let s;return a(t,mt,(t=>n(0,s=t))),[s]}return new class extends ct{constructor(t){super(),lt(this,t,nn,en,o,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
